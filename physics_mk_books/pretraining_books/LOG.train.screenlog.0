
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ python3 domain_knowledge_finetuning.py 
[?2004l/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Traceback (most recent call last):
  File "/home/aribra/llama2/domain_knowledge_finetuning.py", line 5, in <module>
    from peft import LoraConfig, get_peft_model, AutoPeftModelForCausalLM
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/__init__.py", line 22, in <module>
    from .auto import (
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/auto.py", line 30, in <module>
    from .mapping import MODEL_TYPE_TO_PEFT_MODEL_MAPPING
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/mapping.py", line 20, in <module>
    from .peft_model import (
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/peft_model.py", line 26, in <module>
    from accelerate import dispatch_model, infer_auto_device_map
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/accelerate/__init__.py", line 3, in <module>
    from .accelerator import Accelerator
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/accelerate/accelerator.py", line 35, in <module>
    from .checkpointing import load_accelerator_state, load_custom_state, save_accelerator_state, save_custom_state
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/accelerate/checkpointing.py", line 24, in <module>
    from .utils import (
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/accelerate/utils/__init__.py", line 131, in <module>
    from .bnb import has_4bit_bnb_layers, load_and_quantize_model
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/accelerate/utils/bnb.py", line 42, in <module>
    import bitsandbytes as bnb
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/__init__.py", line 6, in <module>
    from . import cuda_setup, utils, research
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/research/__init__.py", line 1, in <module>
    from . import nn
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/research/nn/__init__.py", line 1, in <module>
    from .modules import LinearFP8Mixed, LinearFP8Global
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/research/nn/modules.py", line 8, in <module>
    from bitsandbytes.optim import GlobalOptimManager
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/optim/__init__.py", line 8, in <module>
    from .adagrad import Adagrad, Adagrad8bit, Adagrad32bit
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/optim/adagrad.py", line 5, in <module>
    from bitsandbytes.optim.optimizer import Optimizer1State
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/optim/optimizer.py", line 12, in <module>
    import bitsandbytes.functional as F
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/bitsandbytes/functional.py", line 12, in <module>
    from scipy.stats import norm
ModuleNotFoundError: No module named 'scipy'
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ [K^C[?2004l[?2004h[?2004l
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ exit
[?2004lexit
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Loading checkpoint shards:   0%|                                                                                                 | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████████████████████▌                                            | 1/2 [00:03<00:03,  3.66s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  2.32s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  2.52s/it]
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/utils/other.py:102: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
  0%|                                                                                                                         | 0/4212 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|                                                                                                              | 1/4212 [00:10<11:59:26, 10.25s/it]  0%|                                                                                                              | 2/4212 [00:18<10:37:48,  9.09s/it]  0%|                                                                                                              | 3/4212 [00:26<10:12:56,  8.74s/it]  0%|                                                                                                              | 4/4212 [00:35<10:01:45,  8.58s/it]  0%|▏                                                                                                              | 5/4212 [00:43<9:55:56,  8.50s/it]  0%|▏                                                                                                              | 6/4212 [00:51<9:51:27,  8.44s/it]  0%|▏                                                                                                              | 7/4212 [01:00<9:48:06,  8.39s/it]  0%|▏                                                                                                              | 8/4212 [01:08<9:44:43,  8.35s/it]  0%|▏                                                                                                              | 9/4212 [01:16<9:41:50,  8.31s/it]  0%|▎                                                                                                             | 10/4212 [01:24<9:39:44,  8.28s/it]                                                                                                                                                       {'loss': 2.0236, 'learning_rate': 0.00019952516619183285, 'epoch': 0.01}
  0%|▎                                                                                                             | 10/4212 [01:24<9:39:44,  8.28s/it]  0%|▎                                                                                                             | 11/4212 [01:33<9:38:12,  8.26s/it]  0%|▎                                                                                                             | 12/4212 [01:41<9:37:16,  8.25s/it]  0%|▎                                                                                                             | 13/4212 [01:49<9:37:36,  8.25s/it]  0%|▎                                                                                                             | 14/4212 [01:57<9:38:00,  8.26s/it]^C^C^C^C^CTraceback (most recent call last):
  File "/home/aribra/llama2/domain_knowledge_finetuning.py", line 79, in <module>
    trainer.train()
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/trainer.py", line 1555, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/trainer.py", line 1865, in _inner_training_loop
    and (torch.isnan(tr_loss_step) or torch.isinf(tr_loss_step))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
^C
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ [K
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ 
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ 
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ python3 domain_knowledge_finetuning.py [18Pconda activate llama2python3 domain_knowledge_finetuning.py 
[?2004l/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/generic.py:309: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Loading checkpoint shards:   0%|                                                                                                 | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████████████████████▌                                            | 1/2 [00:03<00:03,  3.26s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.05s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.23s/it]
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/utils/other.py:102: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
  0%|                                                                                                                         | 0/2108 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|                                                                                                              | 1/2108 [00:18<11:03:02, 18.88s/it]  0%|                                                                                                              | 2/2108 [00:35<10:16:10, 17.55s/it]  0%|▏                                                                                                             | 3/2108 [00:52<10:00:06, 17.11s/it]  0%|▏                                                                                                              | 4/2108 [01:08<9:51:55, 16.88s/it]  0%|▎                                                                                                              | 5/2108 [01:25<9:46:46, 16.74s/it]  0%|▎                                                                                                              | 6/2108 [01:41<9:43:34, 16.66s/it]  0%|▎                                                                                                              | 7/2108 [01:58<9:41:41, 16.61s/it]  0%|▍                                                                                                              | 8/2108 [02:14<9:40:46, 16.59s/it]  0%|▍                                                                                                              | 9/2108 [02:31<9:40:17, 16.59s/it]  0%|▌                                                                                                             | 10/2108 [02:47<9:39:38, 16.58s/it]                                                                                                                                                       {'loss': 2.0205, 'learning_rate': 0.00019905123339658445, 'epoch': 0.02}
  0%|▌                                                                                                             | 10/2108 [02:47<9:39:38, 16.58s/it]  1%|▌                                                                                                             | 11/2108 [03:04<9:38:54, 16.56s/it]  1%|▋                                                                                                             | 12/2108 [03:20<9:38:06, 16.55s/it]  1%|▋                                                                                                             | 13/2108 [03:37<9:37:28, 16.54s/it]  1%|▋                                                                                                             | 14/2108 [03:53<9:37:10, 16.54s/it]  1%|▊                                                                                                             | 15/2108 [04:10<9:37:03, 16.54s/it]  1%|▊                                                                                                             | 16/2108 [04:27<9:36:55, 16.55s/it]  1%|▉                                                                                                             | 17/2108 [04:43<9:36:43, 16.55s/it]  1%|▉                                                                                                             | 18/2108 [05:00<9:36:17, 16.54s/it]  1%|▉                                                                                                             | 19/2108 [05:16<9:35:55, 16.54s/it]  1%|█                                                                                                             | 20/2108 [05:33<9:35:34, 16.54s/it]                                                                                                                                                       {'loss': 1.9188, 'learning_rate': 0.0001981024667931689, 'epoch': 0.04}
  1%|█                                                                                                             | 20/2108 [05:33<9:35:34, 16.54s/it]  1%|█                                                                                                             | 21/2108 [05:49<9:35:14, 16.54s/it]  1%|█▏                                                                                                            | 22/2108 [06:06<9:34:55, 16.54s/it]  1%|█▏                                                                                                            | 23/2108 [06:22<9:34:37, 16.54s/it]  1%|█▎                                                                                                            | 24/2108 [06:39<9:34:20, 16.54s/it]  1%|█▎                                                                                                            | 25/2108 [06:55<9:34:15, 16.54s/it]  1%|█▎                                                                                                            | 26/2108 [07:12<9:33:54, 16.54s/it]  1%|█▍                                                                                                            | 27/2108 [07:28<9:33:35, 16.54s/it]  1%|█▍                                                                                                            | 28/2108 [07:45<9:33:29, 16.54s/it]  1%|█▌                                                                                                            | 29/2108 [08:02<9:33:07, 16.54s/it]  1%|█▌                                                                                                            | 30/2108 [08:18<9:32:47, 16.54s/it]                                                                                                                                                       {'loss': 1.8744, 'learning_rate': 0.00019715370018975333, 'epoch': 0.06}
  1%|█▌                                                                                                            | 30/2108 [08:18<9:32:47, 16.54s/it]  1%|█▌                                                                                                            | 31/2108 [08:35<9:32:28, 16.54s/it]  2%|█▋                                                                                                            | 32/2108 [08:51<9:32:09, 16.54s/it]  2%|█▋                                                                                                            | 33/2108 [09:08<9:32:04, 16.54s/it]  2%|█▊                                                                                                            | 34/2108 [09:24<9:31:42, 16.54s/it]  2%|█▊                                                                                                            | 35/2108 [09:41<9:31:24, 16.54s/it]  2%|█▉                                                                                                            | 36/2108 [09:57<9:31:04, 16.54s/it]  2%|█▉                                                                                                            | 37/2108 [10:14<9:30:47, 16.54s/it]  2%|█▉                                                                                                            | 38/2108 [10:30<9:30:28, 16.54s/it]  2%|██                                                                                                            | 39/2108 [10:47<9:30:11, 16.54s/it]  2%|██                                                                                                            | 40/2108 [11:03<9:29:54, 16.53s/it]                                                                                                                                                       {'loss': 1.8282, 'learning_rate': 0.00019620493358633777, 'epoch': 0.08}
  2%|██                                                                                                            | 40/2108 [11:03<9:29:54, 16.53s/it]  2%|██▏                                                                                                           | 41/2108 [11:20<9:29:38, 16.54s/it]  2%|██▏                                                                                                           | 42/2108 [11:36<9:29:20, 16.53s/it]  2%|██▏                                                                                                           | 43/2108 [11:53<9:29:04, 16.53s/it]  2%|██▎                                                                                                           | 44/2108 [12:10<9:28:47, 16.53s/it]  2%|██▎                                                                                                           | 45/2108 [12:26<9:28:32, 16.54s/it]  2%|██▍                                                                                                           | 46/2108 [12:43<9:28:26, 16.54s/it]  2%|██▍                                                                                                           | 47/2108 [12:59<9:28:19, 16.54s/it]  2%|██▌                                                                                                           | 48/2108 [13:16<9:27:54, 16.54s/it]  2%|██▌                                                                                                           | 49/2108 [13:32<9:27:33, 16.54s/it]  2%|██▌                                                                                                           | 50/2108 [13:49<9:27:16, 16.54s/it]                                                                                                                                                       {'loss': 1.799, 'learning_rate': 0.00019525616698292222, 'epoch': 0.09}
  2%|██▌                                                                                                           | 50/2108 [13:49<9:27:16, 16.54s/it]  2%|██▋                                                                                                           | 51/2108 [14:05<9:26:56, 16.54s/it]  2%|██▋                                                                                                           | 52/2108 [14:22<9:26:37, 16.54s/it]  3%|██▊                                                                                                           | 53/2108 [14:38<9:26:20, 16.54s/it]  3%|██▊                                                                                                           | 54/2108 [14:55<9:26:03, 16.54s/it]  3%|██▊                                                                                                           | 55/2108 [15:11<9:25:45, 16.53s/it]  3%|██▉                                                                                                           | 56/2108 [15:28<9:25:17, 16.53s/it]  3%|██▉                                                                                                           | 57/2108 [15:45<9:25:03, 16.53s/it]  3%|███                                                                                                           | 58/2108 [16:01<9:24:49, 16.53s/it]  3%|███                                                                                                           | 59/2108 [16:18<9:24:35, 16.53s/it]  3%|███▏                                                                                                          | 60/2108 [16:34<9:24:19, 16.53s/it]                                                                                                                                                       {'loss': 1.7666, 'learning_rate': 0.00019430740037950666, 'epoch': 0.11}
  3%|███▏                                                                                                          | 60/2108 [16:34<9:24:19, 16.53s/it]  3%|███▏                                                                                                          | 61/2108 [16:51<9:24:04, 16.53s/it]  3%|███▏                                                                                                          | 62/2108 [17:07<9:23:49, 16.53s/it]  3%|███▎                                                                                                          | 63/2108 [17:24<9:23:32, 16.53s/it]  3%|███▎                                                                                                          | 64/2108 [17:40<9:23:27, 16.54s/it]  3%|███▍                                                                                                          | 65/2108 [17:57<9:23:19, 16.54s/it]  3%|███▍                                                                                                          | 66/2108 [18:13<9:23:09, 16.55s/it]  3%|███▍                                                                                                          | 67/2108 [18:30<9:22:57, 16.55s/it]  3%|███▌                                                                                                          | 68/2108 [18:46<9:22:31, 16.54s/it]  3%|███▌                                                                                                          | 69/2108 [19:03<9:22:08, 16.54s/it]  3%|███▋                                                                                                          | 70/2108 [19:20<9:21:35, 16.53s/it]                                                                                                                                                       {'loss': 1.7614, 'learning_rate': 0.0001933586337760911, 'epoch': 0.13}
  3%|███▋                                                                                                          | 70/2108 [19:20<9:21:35, 16.53s/it]  3%|███▋                                                                                                          | 71/2108 [19:36<9:21:31, 16.54s/it]  3%|███▊                                                                                                          | 72/2108 [19:53<9:21:11, 16.54s/it]  3%|███▊                                                                                                          | 73/2108 [20:09<9:20:52, 16.54s/it]  4%|███▊                                                                                                          | 74/2108 [20:26<9:20:35, 16.54s/it]  4%|███▉                                                                                                          | 75/2108 [20:42<9:20:17, 16.54s/it]  4%|███▉                                                                                                          | 76/2108 [20:59<9:19:59, 16.54s/it]  4%|████                                                                                                          | 77/2108 [21:15<9:19:55, 16.54s/it]  4%|████                                                                                                          | 78/2108 [21:32<9:19:46, 16.55s/it]  4%|████                                                                                                          | 79/2108 [21:48<9:19:23, 16.54s/it]  4%|████▏                                                                                                         | 80/2108 [22:05<9:19:03, 16.54s/it]                                                                                                                                                       {'loss': 1.6856, 'learning_rate': 0.00019240986717267554, 'epoch': 0.15}
  4%|████▏                                                                                                         | 80/2108 [22:05<9:19:03, 16.54s/it]  4%|████▏                                                                                                         | 81/2108 [22:21<9:18:54, 16.54s/it]  4%|████▎                                                                                                         | 82/2108 [22:38<9:18:31, 16.54s/it]  4%|████▎                                                                                                         | 83/2108 [22:55<9:18:11, 16.54s/it]  4%|████▍                                                                                                         | 84/2108 [23:11<9:17:51, 16.54s/it]  4%|████▍                                                                                                         | 85/2108 [23:28<9:17:22, 16.53s/it]  4%|████▍                                                                                                         | 86/2108 [23:44<9:17:08, 16.53s/it]  4%|████▌                                                                                                         | 87/2108 [24:01<9:17:04, 16.54s/it]  4%|████▌                                                                                                         | 88/2108 [24:17<9:16:56, 16.54s/it]  4%|████▋                                                                                                         | 89/2108 [24:34<9:16:34, 16.54s/it]  4%|████▋                                                                                                         | 90/2108 [24:50<9:16:03, 16.53s/it]                                                                                                                                                       {'loss': 1.681, 'learning_rate': 0.00019146110056925995, 'epoch': 0.17}
  4%|████▋                                                                                                         | 90/2108 [24:50<9:16:03, 16.53s/it]  4%|████▋                                                                                                         | 91/2108 [25:07<9:15:47, 16.53s/it]  4%|████▊                                                                                                         | 92/2108 [25:23<9:15:32, 16.53s/it]  4%|████▊                                                                                                         | 93/2108 [25:40<9:15:27, 16.54s/it]  4%|████▉                                                                                                         | 94/2108 [25:56<9:15:08, 16.54s/it]  5%|████▉                                                                                                         | 95/2108 [26:13<9:14:48, 16.54s/it]  5%|█████                                                                                                         | 96/2108 [26:30<9:14:17, 16.53s/it]  5%|█████                                                                                                         | 97/2108 [26:46<9:13:52, 16.53s/it]  5%|█████                                                                                                         | 98/2108 [27:03<9:13:42, 16.53s/it]  5%|█████▏                                                                                                        | 99/2108 [27:19<9:13:30, 16.53s/it]  5%|█████▏                                                                                                       | 100/2108 [27:36<9:13:26, 16.54s/it]                                                                                                                                                       {'loss': 1.6864, 'learning_rate': 0.0001905123339658444, 'epoch': 0.19}
  5%|█████▏                                                                                                       | 100/2108 [27:36<9:13:26, 16.54s/it]/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  5%|█████▏                                                                                                       | 101/2108 [27:53<9:21:45, 16.79s/it]  5%|█████▎                                                                                                       | 102/2108 [28:10<9:18:52, 16.72s/it]  5%|█████▎                                                                                                       | 103/2108 [28:26<9:16:46, 16.66s/it]  5%|█████▍                                                                                                       | 104/2108 [28:43<9:15:25, 16.63s/it]  5%|█████▍                                                                                                       | 105/2108 [28:59<9:14:12, 16.60s/it]  5%|█████▍                                                                                                       | 106/2108 [29:16<9:13:27, 16.59s/it]  5%|█████▌                                                                                                       | 107/2108 [29:32<9:12:39, 16.57s/it]  5%|█████▌                                                                                                       | 108/2108 [29:49<9:12:12, 16.57s/it]  5%|█████▋                                                                                                       | 109/2108 [30:05<9:11:36, 16.56s/it]  5%|█████▋                                                                                                       | 110/2108 [30:22<9:11:05, 16.55s/it]                                                                                                                                                       {'loss': 1.6759, 'learning_rate': 0.00018956356736242886, 'epoch': 0.21}
  5%|█████▋                                                                                                       | 110/2108 [30:22<9:11:05, 16.55s/it]  5%|█████▋                                                                                                       | 111/2108 [30:24<6:46:23, 12.21s/it]  5%|█████▊                                                                                                       | 112/2108 [30:41<7:31:54, 13.58s/it]  5%|█████▊                                                                                                       | 113/2108 [30:57<8:01:07, 14.47s/it]  5%|█████▉                                                                                                       | 114/2108 [31:14<8:21:28, 15.09s/it]  5%|█████▉                                                                                                       | 115/2108 [31:30<8:35:50, 15.53s/it]  6%|█████▉                                                                                                       | 116/2108 [31:47<8:45:47, 15.84s/it]  6%|██████                                                                                                       | 117/2108 [32:04<8:52:29, 16.05s/it]  6%|██████                                                                                                       | 118/2108 [32:20<8:57:04, 16.19s/it]  6%|██████▏                                                                                                      | 119/2108 [32:37<9:00:01, 16.29s/it]  6%|██████▏                                                                                                      | 120/2108 [32:53<9:02:11, 16.36s/it]                                                                                                                                                       {'loss': 1.6081, 'learning_rate': 0.0001886148007590133, 'epoch': 1.02}
  6%|██████▏                                                                                                      | 120/2108 [32:53<9:02:11, 16.36s/it]  6%|██████▎                                                                                                      | 121/2108 [33:10<9:03:49, 16.42s/it]  6%|██████▎                                                                                                      | 122/2108 [33:26<9:04:40, 16.46s/it]  6%|██████▎                                                                                                      | 123/2108 [33:43<9:05:11, 16.48s/it]  6%|██████▍                                                                                                      | 124/2108 [33:59<9:05:17, 16.49s/it]  6%|██████▍                                                                                                      | 125/2108 [34:16<9:05:27, 16.50s/it]  6%|██████▌                                                                                                      | 126/2108 [34:32<9:05:41, 16.52s/it]  6%|██████▌                                                                                                      | 127/2108 [34:49<9:05:46, 16.53s/it]  6%|██████▌                                                                                                      | 128/2108 [35:05<9:05:44, 16.54s/it]  6%|██████▋                                                                                                      | 129/2108 [35:22<9:05:26, 16.54s/it]  6%|██████▋                                                                                                      | 130/2108 [35:39<9:05:08, 16.54s/it]                                                                                                                                                       {'loss': 1.6081, 'learning_rate': 0.00018766603415559774, 'epoch': 1.04}
  6%|██████▋                                                                                                      | 130/2108 [35:39<9:05:08, 16.54s/it]  6%|██████▊                                                                                                      | 131/2108 [35:55<9:04:51, 16.54s/it]  6%|██████▊                                                                                                      | 132/2108 [36:12<9:04:34, 16.54s/it]  6%|██████▉                                                                                                      | 133/2108 [36:28<9:04:17, 16.54s/it]  6%|██████▉                                                                                                      | 134/2108 [36:45<9:03:49, 16.53s/it]  6%|██████▉                                                                                                      | 135/2108 [37:01<9:03:36, 16.53s/it]  6%|███████                                                                                                      | 136/2108 [37:18<9:03:22, 16.53s/it]  6%|███████                                                                                                      | 137/2108 [37:34<9:02:55, 16.53s/it]  7%|███████▏                                                                                                     | 138/2108 [37:51<9:02:54, 16.54s/it]  7%|███████▏                                                                                                     | 139/2108 [38:07<9:02:38, 16.54s/it]  7%|███████▏                                                                                                     | 140/2108 [38:24<9:02:21, 16.54s/it]                                                                                                                                                       {'loss': 1.591, 'learning_rate': 0.00018671726755218219, 'epoch': 1.06}
  7%|███████▏                                                                                                     | 140/2108 [38:24<9:02:21, 16.54s/it]  7%|███████▎                                                                                                     | 141/2108 [38:40<9:02:04, 16.54s/it]  7%|███████▎                                                                                                     | 142/2108 [38:57<9:01:36, 16.53s/it]  7%|███████▍                                                                                                     | 143/2108 [39:13<9:01:23, 16.53s/it]  7%|███████▍                                                                                                     | 144/2108 [39:30<9:01:09, 16.53s/it]  7%|███████▍                                                                                                     | 145/2108 [39:46<9:00:42, 16.53s/it]  7%|███████▌                                                                                                     | 146/2108 [40:03<9:00:31, 16.53s/it]  7%|███████▌                                                                                                     | 147/2108 [40:20<9:00:17, 16.53s/it]  7%|███████▋                                                                                                     | 148/2108 [40:36<9:00:02, 16.53s/it]  7%|███████▋                                                                                                     | 149/2108 [40:53<8:59:37, 16.53s/it]  7%|███████▊                                                                                                     | 150/2108 [41:09<8:59:36, 16.54s/it]                                                                                                                                                       {'loss': 1.5893, 'learning_rate': 0.0001857685009487666, 'epoch': 1.07}
  7%|███████▊                                                                                                     | 150/2108 [41:09<8:59:36, 16.54s/it]  7%|███████▊                                                                                                     | 151/2108 [41:26<8:59:31, 16.54s/it]  7%|███████▊                                                                                                     | 152/2108 [41:42<8:59:11, 16.54s/it]  7%|███████▉                                                                                                     | 153/2108 [41:59<8:58:52, 16.54s/it]  7%|███████▉                                                                                                     | 154/2108 [42:15<8:58:33, 16.54s/it]  7%|████████                                                                                                     | 155/2108 [42:32<8:58:02, 16.53s/it]  7%|████████                                                                                                     | 156/2108 [42:48<8:57:38, 16.53s/it]  7%|████████                                                                                                     | 157/2108 [43:05<8:57:26, 16.53s/it]  7%|████████▏                                                                                                    | 158/2108 [43:21<8:57:14, 16.53s/it]  8%|████████▏                                                                                                    | 159/2108 [43:38<8:57:01, 16.53s/it]  8%|████████▎                                                                                                    | 160/2108 [43:54<8:56:57, 16.54s/it]                                                                                                                                                       {'loss': 1.6264, 'learning_rate': 0.00018481973434535104, 'epoch': 1.09}
  8%|████████▎                                                                                                    | 160/2108 [43:54<8:56:57, 16.54s/it]  8%|████████▎                                                                                                    | 161/2108 [44:11<8:56:37, 16.54s/it]  8%|████████▍                                                                                                    | 162/2108 [44:28<8:56:08, 16.53s/it]  8%|████████▍                                                                                                    | 163/2108 [44:44<8:55:43, 16.53s/it]  8%|████████▍                                                                                                    | 164/2108 [45:01<8:55:31, 16.53s/it]  8%|████████▌                                                                                                    | 165/2108 [45:17<8:55:18, 16.53s/it]  8%|████████▌                                                                                                    | 166/2108 [45:34<8:55:04, 16.53s/it]  8%|████████▋                                                                                                    | 167/2108 [45:50<8:55:01, 16.54s/it]  8%|████████▋                                                                                                    | 168/2108 [46:07<8:54:41, 16.54s/it]  8%|████████▋                                                                                                    | 169/2108 [46:23<8:54:13, 16.53s/it]  8%|████████▊                                                                                                    | 170/2108 [46:40<8:53:58, 16.53s/it]                                                                                                                                                       {'loss': 1.5577, 'learning_rate': 0.00018387096774193548, 'epoch': 1.11}
  8%|████████▊                                                                                                    | 170/2108 [46:40<8:53:58, 16.53s/it]  8%|████████▊                                                                                                    | 171/2108 [46:56<8:53:43, 16.53s/it]  8%|████████▉                                                                                                    | 172/2108 [47:13<8:53:39, 16.54s/it]  8%|████████▉                                                                                                    | 173/2108 [47:29<8:53:20, 16.54s/it]  8%|████████▉                                                                                                    | 174/2108 [47:46<8:53:01, 16.54s/it]  8%|█████████                                                                                                    | 175/2108 [48:02<8:52:44, 16.54s/it]  8%|█████████                                                                                                    | 176/2108 [48:19<8:52:16, 16.53s/it]  8%|█████████▏                                                                                                   | 177/2108 [48:36<8:52:02, 16.53s/it]  8%|█████████▏                                                                                                   | 178/2108 [48:52<8:51:47, 16.53s/it]  8%|█████████▎                                                                                                   | 179/2108 [49:09<8:51:32, 16.53s/it]  9%|█████████▎                                                                                                   | 180/2108 [49:25<8:51:28, 16.54s/it]                                                                                                                                                       {'loss': 1.5867, 'learning_rate': 0.00018292220113851992, 'epoch': 1.13}
  9%|█████████▎                                                                                                   | 180/2108 [49:25<8:51:28, 16.54s/it]  9%|█████████▎                                                                                                   | 181/2108 [49:42<8:51:09, 16.54s/it]  9%|█████████▍                                                                                                   | 182/2108 [49:58<8:50:49, 16.54s/it]  9%|█████████▍                                                                                                   | 183/2108 [50:15<8:50:21, 16.53s/it]  9%|█████████▌                                                                                                   | 184/2108 [50:31<8:50:07, 16.53s/it]  9%|█████████▌                                                                                                   | 185/2108 [50:48<8:50:03, 16.54s/it]  9%|█████████▌                                                                                                   | 186/2108 [51:04<8:49:45, 16.54s/it]  9%|█████████▋                                                                                                   | 187/2108 [51:21<8:49:27, 16.54s/it]  9%|█████████▋                                                                                                   | 188/2108 [51:37<8:49:08, 16.54s/it]  9%|█████████▊                                                                                                   | 189/2108 [51:54<8:48:52, 16.54s/it]  9%|█████████▊                                                                                                   | 190/2108 [52:11<8:48:34, 16.54s/it]                                                                                                                                                       {'loss': 1.5684, 'learning_rate': 0.0001819734345351044, 'epoch': 1.15}
  9%|█████████▊                                                                                                   | 190/2108 [52:11<8:48:34, 16.54s/it]  9%|█████████▉                                                                                                   | 191/2108 [52:27<8:48:29, 16.54s/it]  9%|█████████▉                                                                                                   | 192/2108 [52:44<8:48:09, 16.54s/it]  9%|█████████▉                                                                                                   | 193/2108 [53:00<8:47:49, 16.54s/it]  9%|██████████                                                                                                   | 194/2108 [53:17<8:47:31, 16.54s/it]  9%|██████████                                                                                                   | 195/2108 [53:33<8:47:13, 16.54s/it]  9%|██████████▏                                                                                                  | 196/2108 [53:50<8:46:55, 16.54s/it]  9%|██████████▏                                                                                                  | 197/2108 [54:06<8:46:38, 16.54s/it]  9%|██████████▏                                                                                                  | 198/2108 [54:23<8:46:10, 16.53s/it]  9%|██████████▎                                                                                                  | 199/2108 [54:39<8:45:57, 16.53s/it]  9%|██████████▎                                                                                                  | 200/2108 [54:56<8:45:42, 16.53s/it]                                                                                                                                                       {'loss': 1.559, 'learning_rate': 0.0001810246679316888, 'epoch': 1.17}
  9%|██████████▎                                                                                                  | 200/2108 [54:56<8:45:42, 16.53s/it]/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 10%|██████████▍                                                                                                  | 201/2108 [55:13<8:53:52, 16.80s/it] 10%|██████████▍                                                                                                  | 202/2108 [55:30<8:51:04, 16.72s/it] 10%|██████████▍                                                                                                  | 203/2108 [55:46<8:49:14, 16.67s/it] 10%|██████████▌                                                                                                  | 204/2108 [56:03<8:47:40, 16.63s/it] 10%|██████████▌                                                                                                  | 205/2108 [56:19<8:46:18, 16.59s/it] 10%|██████████▋                                                                                                  | 206/2108 [56:36<8:45:17, 16.57s/it] 10%|██████████▋                                                                                                  | 207/2108 [56:52<8:44:40, 16.56s/it] 10%|██████████▊                                                                                                  | 208/2108 [57:09<8:44:08, 16.55s/it] 10%|██████████▊                                                                                                  | 209/2108 [57:26<8:43:42, 16.55s/it] 10%|██████████▊                                                                                                  | 210/2108 [57:42<8:43:18, 16.54s/it]                                                                                                                                                       {'loss': 1.5653, 'learning_rate': 0.00018007590132827325, 'epoch': 1.19}
 10%|██████████▊                                                                                                  | 210/2108 [57:42<8:43:18, 16.54s/it] 10%|██████████▉                                                                                                  | 211/2108 [57:59<8:42:46, 16.53s/it] 10%|██████████▉                                                                                                  | 212/2108 [58:15<8:42:21, 16.53s/it] 10%|███████████                                                                                                  | 213/2108 [58:32<8:42:03, 16.53s/it] 10%|███████████                                                                                                  | 214/2108 [58:48<8:41:50, 16.53s/it] 10%|███████████                                                                                                  | 215/2108 [59:05<8:41:35, 16.53s/it] 10%|███████████▏                                                                                                 | 216/2108 [59:21<8:41:20, 16.53s/it] 10%|███████████▏                                                                                                 | 217/2108 [59:38<8:41:04, 16.53s/it] 10%|███████████▎                                                                                                 | 218/2108 [59:54<8:40:37, 16.53s/it] 10%|███████████                                                                                                | 219/2108 [1:00:11<8:40:24, 16.53s/it] 10%|███████████▏                                                                                               | 220/2108 [1:00:27<8:40:10, 16.53s/it]                                                                                                                                                       {'loss': 1.4604, 'learning_rate': 0.00017922201138519925, 'epoch': 1.21}
 10%|███████████▏                                                                                               | 220/2108 [1:00:27<8:40:10, 16.53s/it] 10%|███████████▏                                                                                               | 221/2108 [1:00:44<8:39:55, 16.53s/it] 11%|███████████▎                                                                                               | 222/2108 [1:00:46<6:23:25, 12.20s/it] 11%|███████████▎                                                                                               | 223/2108 [1:01:03<7:07:48, 13.62s/it] 11%|███████████▎                                                                                               | 224/2108 [1:01:19<7:34:52, 14.49s/it] 11%|███████████▍                                                                                               | 225/2108 [1:01:36<7:53:55, 15.10s/it] 11%|███████████▍                                                                                               | 226/2108 [1:01:52<8:07:09, 15.53s/it] 11%|███████████▌                                                                                               | 227/2108 [1:02:09<8:16:19, 15.83s/it] 11%|███████████▌                                                                                               | 228/2108 [1:02:26<8:22:21, 16.03s/it] 11%|███████████▌                                                                                               | 229/2108 [1:02:42<8:26:45, 16.18s/it] 11%|███████████▋                                                                                               | 230/2108 [1:02:59<8:29:48, 16.29s/it]                                                                                                                                                       {'loss': 1.463, 'learning_rate': 0.00017836812144212525, 'epoch': 2.02}
 11%|███████████▋                                                                                               | 230/2108 [1:02:59<8:29:48, 16.29s/it] 11%|███████████▋                                                                                               | 231/2108 [1:03:15<8:31:50, 16.36s/it] 11%|███████████▊                                                                                               | 232/2108 [1:03:32<8:33:10, 16.41s/it] 11%|███████████▊                                                                                               | 233/2108 [1:03:48<8:34:02, 16.45s/it] 11%|███████████▉                                                                                               | 234/2108 [1:04:05<8:34:34, 16.48s/it] 11%|███████████▉                                                                                               | 235/2108 [1:04:21<8:34:40, 16.49s/it] 11%|███████████▉                                                                                               | 236/2108 [1:04:38<8:35:01, 16.51s/it] 11%|████████████                                                                                               | 237/2108 [1:04:54<8:35:01, 16.52s/it] 11%|████████████                                                                                               | 238/2108 [1:05:11<8:34:55, 16.52s/it] 11%|████████████▏                                                                                              | 239/2108 [1:05:27<8:34:46, 16.53s/it] 11%|████████████▏                                                                                              | 240/2108 [1:05:44<8:34:35, 16.53s/it]                                                                                                                                                       {'loss': 1.4842, 'learning_rate': 0.0001774193548387097, 'epoch': 2.03}
 11%|████████████▏                                                                                              | 240/2108 [1:05:44<8:34:35, 16.53s/it] 11%|████████████▏                                                                                              | 241/2108 [1:06:00<8:34:11, 16.52s/it] 11%|████████████▎                                                                                              | 242/2108 [1:06:17<8:34:01, 16.53s/it] 12%|████████████▎                                                                                              | 243/2108 [1:06:34<8:33:48, 16.53s/it] 12%|████████████▍                                                                                              | 244/2108 [1:06:50<8:33:35, 16.53s/it] 12%|████████████▍                                                                                              | 245/2108 [1:07:07<8:33:19, 16.53s/it] 12%|████████████▍                                                                                              | 246/2108 [1:07:23<8:33:05, 16.53s/it] 12%|████████████▌                                                                                              | 247/2108 [1:07:40<8:32:41, 16.53s/it] 12%|████████████▌                                                                                              | 248/2108 [1:07:56<8:32:24, 16.53s/it] 12%|████████████▋                                                                                              | 249/2108 [1:08:13<8:32:11, 16.53s/it] 12%|████████████▋                                                                                              | 250/2108 [1:08:29<8:31:57, 16.53s/it]                                                                                                                                                       {'loss': 1.4284, 'learning_rate': 0.0001765654648956357, 'epoch': 2.05}
 12%|████████████▋                                                                                              | 250/2108 [1:08:29<8:31:57, 16.53s/it] 12%|████████████▋                                                                                              | 251/2108 [1:08:46<8:31:30, 16.53s/it] 12%|████████████▊                                                                                              | 252/2108 [1:09:02<8:31:07, 16.52s/it] 12%|████████████▊                                                                                              | 253/2108 [1:09:19<8:30:47, 16.52s/it] 12%|████████████▉                                                                                              | 254/2108 [1:09:35<8:30:27, 16.52s/it] 12%|████████████▉                                                                                              | 255/2108 [1:09:52<8:30:29, 16.53s/it] 12%|████████████▉                                                                                              | 256/2108 [1:10:08<8:30:16, 16.53s/it] 12%|█████████████                                                                                              | 257/2108 [1:10:25<8:30:01, 16.53s/it] 12%|█████████████                                                                                              | 258/2108 [1:10:41<8:29:34, 16.53s/it] 12%|█████████████▏                                                                                             | 259/2108 [1:10:58<8:29:11, 16.52s/it] 12%|█████████████▏                                                                                             | 260/2108 [1:11:14<8:28:50, 16.52s/it]                                                                                                                                                       {'loss': 1.4512, 'learning_rate': 0.00017561669829222013, 'epoch': 2.07}
 12%|█████████████▏                                                                                             | 260/2108 [1:11:14<8:28:50, 16.52s/it] 12%|█████████████▏                                                                                             | 261/2108 [1:11:31<8:28:42, 16.53s/it] 12%|█████████████▎                                                                                             | 262/2108 [1:11:48<8:28:32, 16.53s/it] 12%|█████████████▎                                                                                             | 263/2108 [1:12:04<8:28:29, 16.54s/it] 13%|█████████████▍                                                                                             | 264/2108 [1:12:21<8:28:22, 16.54s/it] 13%|█████████████▍                                                                                             | 265/2108 [1:12:37<8:28:12, 16.55s/it] 13%|█████████████▌                                                                                             | 266/2108 [1:12:54<8:27:51, 16.54s/it] 13%|█████████████▌                                                                                             | 267/2108 [1:13:10<8:27:30, 16.54s/it] 13%|█████████████▌                                                                                             | 268/2108 [1:13:27<8:26:59, 16.53s/it] 13%|█████████████▋                                                                                             | 269/2108 [1:13:43<8:26:44, 16.53s/it] 13%|█████████████▋                                                                                             | 270/2108 [1:14:00<8:26:40, 16.54s/it]                                                                                                                                                       {'loss': 1.4603, 'learning_rate': 0.00017466793168880454, 'epoch': 2.09}
 13%|█████████████▋                                                                                             | 270/2108 [1:14:00<8:26:40, 16.54s/it] 13%|█████████████▊                                                                                             | 271/2108 [1:14:16<8:26:20, 16.54s/it] 13%|█████████████▊                                                                                             | 272/2108 [1:14:33<8:25:51, 16.53s/it] 13%|█████████████▊                                                                                             | 273/2108 [1:14:49<8:25:25, 16.53s/it] 13%|█████████████▉                                                                                             | 274/2108 [1:15:06<8:25:14, 16.53s/it] 13%|█████████████▉                                                                                             | 275/2108 [1:15:23<8:25:00, 16.53s/it] 13%|██████████████                                                                                             | 276/2108 [1:15:39<8:24:34, 16.53s/it] 13%|██████████████                                                                                             | 277/2108 [1:15:56<8:24:24, 16.53s/it] 13%|██████████████                                                                                             | 278/2108 [1:16:12<8:24:10, 16.53s/it] 13%|██████████████▏                                                                                            | 279/2108 [1:16:29<8:23:46, 16.53s/it] 13%|██████████████▏                                                                                            | 280/2108 [1:16:45<8:23:33, 16.53s/it]                                                                                                                                                       {'loss': 1.3787, 'learning_rate': 0.000173719165085389, 'epoch': 2.11}
 13%|██████████████▏                                                                                            | 280/2108 [1:16:45<8:23:33, 16.53s/it] 13%|██████████████▎                                                                                            | 281/2108 [1:17:02<8:23:09, 16.52s/it] 13%|██████████████▎                                                                                            | 282/2108 [1:17:18<8:23:10, 16.53s/it] 13%|██████████████▎                                                                                            | 283/2108 [1:17:35<8:22:54, 16.53s/it] 13%|██████████████▍                                                                                            | 284/2108 [1:17:51<8:22:38, 16.53s/it] 14%|██████████████▍                                                                                            | 285/2108 [1:18:08<8:22:11, 16.53s/it] 14%|██████████████▌                                                                                            | 286/2108 [1:18:24<8:21:57, 16.53s/it] 14%|██████████████▌                                                                                            | 287/2108 [1:18:41<8:21:44, 16.53s/it] 14%|██████████████▌                                                                                            | 288/2108 [1:18:57<8:21:29, 16.53s/it] 14%|██████████████▋                                                                                            | 289/2108 [1:19:14<8:21:13, 16.53s/it] 14%|██████████████▋                                                                                            | 290/2108 [1:19:30<8:20:47, 16.53s/it]                                                                                                                                                       {'loss': 1.4512, 'learning_rate': 0.00017277039848197345, 'epoch': 2.13}
 14%|██████████████▋                                                                                            | 290/2108 [1:19:30<8:20:47, 16.53s/it] 14%|██████████████▊                                                                                            | 291/2108 [1:19:47<8:20:33, 16.53s/it] 14%|██████████████▊                                                                                            | 292/2108 [1:20:04<8:20:09, 16.52s/it] 14%|██████████████▊                                                                                            | 293/2108 [1:20:20<8:19:59, 16.53s/it] 14%|██████████████▉                                                                                            | 294/2108 [1:20:37<8:19:56, 16.54s/it] 14%|██████████████▉                                                                                            | 295/2108 [1:20:53<8:19:39, 16.54s/it] 14%|███████████████                                                                                            | 296/2108 [1:21:10<8:19:21, 16.54s/it] 14%|███████████████                                                                                            | 297/2108 [1:21:26<8:18:53, 16.53s/it] 14%|███████████████▏                                                                                           | 298/2108 [1:21:43<8:18:40, 16.53s/it] 14%|███████████████▏                                                                                           | 299/2108 [1:21:59<8:18:15, 16.53s/it] 14%|███████████████▏                                                                                           | 300/2108 [1:22:16<8:18:03, 16.53s/it]                                                                                                                                                       {'loss': 1.4114, 'learning_rate': 0.0001718216318785579, 'epoch': 2.15}
 14%|███████████████▏                                                                                           | 300/2108 [1:22:16<8:18:03, 16.53s/it]/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 14%|███████████████▎                                                                                           | 301/2108 [1:22:33<8:25:26, 16.78s/it] 14%|███████████████▎                                                                                           | 302/2108 [1:22:50<8:22:54, 16.71s/it] 14%|███████████████▍                                                                                           | 303/2108 [1:23:06<8:21:03, 16.66s/it] 14%|███████████████▍                                                                                           | 304/2108 [1:23:23<8:19:41, 16.62s/it] 14%|███████████████▍                                                                                           | 305/2108 [1:23:39<8:18:28, 16.59s/it] 15%|███████████████▌                                                                                           | 306/2108 [1:23:56<8:17:32, 16.57s/it] 15%|███████████████▌                                                                                           | 307/2108 [1:24:12<8:16:58, 16.56s/it] 15%|███████████████▋                                                                                           | 308/2108 [1:24:29<8:16:40, 16.56s/it] 15%|███████████████▋                                                                                           | 309/2108 [1:24:45<8:16:12, 16.55s/it] 15%|███████████████▋                                                                                           | 310/2108 [1:25:02<8:15:48, 16.55s/it]                                                                                                                                                       {'loss': 1.3808, 'learning_rate': 0.00017087286527514233, 'epoch': 2.17}
 15%|███████████████▋                                                                                           | 310/2108 [1:25:02<8:15:48, 16.55s/it] 15%|███████████████▊                                                                                           | 311/2108 [1:25:18<8:15:15, 16.54s/it] 15%|███████████████▊                                                                                           | 312/2108 [1:25:35<8:14:57, 16.54s/it] 15%|███████████████▉                                                                                           | 313/2108 [1:25:52<8:14:40, 16.54s/it] 15%|███████████████▉                                                                                           | 314/2108 [1:26:08<8:14:13, 16.53s/it] 15%|███████████████▉                                                                                           | 315/2108 [1:26:25<8:13:48, 16.52s/it] 15%|████████████████                                                                                           | 316/2108 [1:26:41<8:13:37, 16.53s/it] 15%|████████████████                                                                                           | 317/2108 [1:26:58<8:13:14, 16.52s/it] 15%|████████████████▏                                                                                          | 318/2108 [1:27:14<8:12:45, 16.52s/it] 15%|████████████████▏                                                                                          | 319/2108 [1:27:31<8:12:46, 16.53s/it] 15%|████████████████▏                                                                                          | 320/2108 [1:27:47<8:12:45, 16.54s/it]                                                                                                                                                       {'loss': 1.3888, 'learning_rate': 0.0001700189753320683, 'epoch': 2.19}
 15%|████████████████▏                                                                                          | 320/2108 [1:27:47<8:12:45, 16.54s/it] 15%|████████████████▎                                                                                          | 321/2108 [1:28:04<8:12:37, 16.54s/it] 15%|████████████████▎                                                                                          | 322/2108 [1:28:20<8:12:18, 16.54s/it] 15%|████████████████▍                                                                                          | 323/2108 [1:28:37<8:11:58, 16.54s/it] 15%|████████████████▍                                                                                          | 324/2108 [1:28:53<8:11:23, 16.53s/it] 15%|████████████████▍                                                                                          | 325/2108 [1:29:10<8:11:07, 16.53s/it] 15%|████████████████▌                                                                                          | 326/2108 [1:29:26<8:10:55, 16.53s/it] 16%|████████████████▌                                                                                          | 327/2108 [1:29:43<8:10:41, 16.53s/it] 16%|████████████████▋                                                                                          | 328/2108 [1:29:59<8:10:27, 16.53s/it] 16%|████████████████▋                                                                                          | 329/2108 [1:30:16<8:10:11, 16.53s/it] 16%|████████████████▊                                                                                          | 330/2108 [1:30:33<8:09:56, 16.53s/it]                                                                                                                                                       {'loss': 1.3591, 'learning_rate': 0.0001691650853889943, 'epoch': 2.2}
 16%|████████████████▊                                                                                          | 330/2108 [1:30:33<8:09:56, 16.53s/it] 16%|████████████████▊                                                                                          | 331/2108 [1:30:49<8:09:39, 16.53s/it] 16%|████████████████▊                                                                                          | 332/2108 [1:31:06<8:09:24, 16.53s/it] 16%|████████████████▉                                                                                          | 333/2108 [1:31:08<6:00:51, 12.20s/it] 16%|████████████████▉                                                                                          | 334/2108 [1:31:24<6:41:25, 13.58s/it] 16%|█████████████████                                                                                          | 335/2108 [1:31:41<7:07:24, 14.46s/it] 16%|█████████████████                                                                                          | 336/2108 [1:31:58<7:25:31, 15.09s/it] 16%|█████████████████                                                                                          | 337/2108 [1:32:14<7:38:05, 15.52s/it] 16%|█████████████████▏                                                                                         | 338/2108 [1:32:31<7:46:49, 15.82s/it] 16%|█████████████████▏                                                                                         | 339/2108 [1:32:47<7:52:49, 16.04s/it] 16%|█████████████████▎                                                                                         | 340/2108 [1:33:04<7:56:47, 16.18s/it]                                                                                                                                                       {'loss': 1.3382, 'learning_rate': 0.00016821631878557875, 'epoch': 3.01}
 16%|█████████████████▎                                                                                         | 340/2108 [1:33:04<7:56:47, 16.18s/it] 16%|█████████████████▎                                                                                         | 341/2108 [1:33:20<7:59:39, 16.29s/it] 16%|█████████████████▎                                                                                         | 342/2108 [1:33:37<8:01:33, 16.36s/it] 16%|█████████████████▍                                                                                         | 343/2108 [1:33:53<8:02:49, 16.41s/it] 16%|█████████████████▍                                                                                         | 344/2108 [1:34:10<8:03:36, 16.45s/it] 16%|█████████████████▌                                                                                         | 345/2108 [1:34:26<8:04:05, 16.48s/it] 16%|█████████████████▌                                                                                         | 346/2108 [1:34:43<8:04:20, 16.49s/it] 16%|█████████████████▌                                                                                         | 347/2108 [1:34:59<8:04:25, 16.51s/it] 17%|█████████████████▋                                                                                         | 348/2108 [1:35:16<8:04:24, 16.51s/it] 17%|█████████████████▋                                                                                         | 349/2108 [1:35:32<8:04:19, 16.52s/it] 17%|█████████████████▊                                                                                         | 350/2108 [1:35:49<8:04:20, 16.53s/it]                                                                                                                                                       {'loss': 1.2796, 'learning_rate': 0.0001672675521821632, 'epoch': 3.03}
 17%|█████████████████▊                                                                                         | 350/2108 [1:35:49<8:04:20, 16.53s/it] 17%|█████████████████▊                                                                                         | 351/2108 [1:36:06<8:04:16, 16.54s/it] 17%|█████████████████▊                                                                                         | 352/2108 [1:36:22<8:03:58, 16.54s/it] 17%|█████████████████▉                                                                                         | 353/2108 [1:36:39<8:03:40, 16.54s/it] 17%|█████████████████▉                                                                                         | 354/2108 [1:36:55<8:03:13, 16.53s/it] 17%|██████████████████                                                                                         | 355/2108 [1:37:12<8:02:59, 16.53s/it] 17%|██████████████████                                                                                         | 356/2108 [1:37:28<8:02:44, 16.53s/it] 17%|██████████████████                                                                                         | 357/2108 [1:37:45<8:02:29, 16.53s/it] 17%|██████████████████▏                                                                                        | 358/2108 [1:38:01<8:02:13, 16.53s/it] 17%|██████████████████▏                                                                                        | 359/2108 [1:38:18<8:01:57, 16.53s/it] 17%|██████████████████▎                                                                                        | 360/2108 [1:38:34<8:01:41, 16.53s/it]                                                                                                                                                       {'loss': 1.3193, 'learning_rate': 0.00016631878557874763, 'epoch': 3.05}
 17%|██████████████████▎                                                                                        | 360/2108 [1:38:34<8:01:41, 16.53s/it] 17%|██████████████████▎                                                                                        | 361/2108 [1:38:51<8:01:24, 16.53s/it] 17%|██████████████████▎                                                                                        | 362/2108 [1:39:07<8:00:58, 16.53s/it] 17%|██████████████████▍                                                                                        | 363/2108 [1:39:24<8:00:45, 16.53s/it] 17%|██████████████████▍                                                                                        | 364/2108 [1:39:40<8:00:30, 16.53s/it] 17%|██████████████████▌                                                                                        | 365/2108 [1:39:57<8:00:06, 16.53s/it] 17%|██████████████████▌                                                                                        | 366/2108 [1:40:14<7:59:54, 16.53s/it] 17%|██████████████████▋                                                                                        | 367/2108 [1:40:30<7:59:40, 16.53s/it] 17%|██████████████████▋                                                                                        | 368/2108 [1:40:47<7:59:37, 16.54s/it] 18%|██████████████████▋                                                                                        | 369/2108 [1:41:03<7:59:17, 16.54s/it] 18%|██████████████████▊                                                                                        | 370/2108 [1:41:20<7:59:00, 16.54s/it]                                                                                                                                                       {'loss': 1.3021, 'learning_rate': 0.0001653700189753321, 'epoch': 3.07}
 18%|██████████████████▊                                                                                        | 370/2108 [1:41:20<7:59:00, 16.54s/it] 18%|██████████████████▊                                                                                        | 371/2108 [1:41:36<7:58:42, 16.54s/it] 18%|██████████████████▉                                                                                        | 372/2108 [1:41:53<7:58:14, 16.53s/it] 18%|██████████████████▉                                                                                        | 373/2108 [1:42:09<7:58:01, 16.53s/it] 18%|██████████████████▉                                                                                        | 374/2108 [1:42:26<7:57:47, 16.53s/it] 18%|███████████████████                                                                                        | 375/2108 [1:42:42<7:57:42, 16.54s/it] 18%|███████████████████                                                                                        | 376/2108 [1:42:59<7:57:23, 16.54s/it] 18%|███████████████████▏                                                                                       | 377/2108 [1:43:15<7:56:55, 16.53s/it] 18%|███████████████████▏                                                                                       | 378/2108 [1:43:32<7:56:29, 16.53s/it] 18%|███████████████████▏                                                                                       | 379/2108 [1:43:48<7:56:07, 16.52s/it] 18%|███████████████████▎                                                                                       | 380/2108 [1:44:05<7:55:58, 16.53s/it]                                                                                                                                                       {'loss': 1.2893, 'learning_rate': 0.0001644212523719165, 'epoch': 3.09}
 18%|███████████████████▎                                                                                       | 380/2108 [1:44:05<7:55:58, 16.53s/it] 18%|███████████████████▎                                                                                       | 381/2108 [1:44:22<7:55:38, 16.52s/it] 18%|███████████████████▍                                                                                       | 382/2108 [1:44:38<7:55:34, 16.53s/it] 18%|███████████████████▍                                                                                       | 383/2108 [1:44:55<7:55:18, 16.53s/it] 18%|███████████████████▍                                                                                       | 384/2108 [1:45:11<7:55:03, 16.53s/it] 18%|███████████████████▌                                                                                       | 385/2108 [1:45:28<7:54:47, 16.53s/it] 18%|███████████████████▌                                                                                       | 386/2108 [1:45:44<7:54:31, 16.53s/it] 18%|███████████████████▋                                                                                       | 387/2108 [1:46:01<7:54:08, 16.53s/it] 18%|███████████████████▋                                                                                       | 388/2108 [1:46:17<7:54:01, 16.54s/it] 18%|███████████████████▋                                                                                       | 389/2108 [1:46:34<7:53:34, 16.53s/it] 19%|███████████████████▊                                                                                       | 390/2108 [1:46:50<7:53:20, 16.53s/it]                                                                                                                                                       {'loss': 1.0755, 'learning_rate': 0.00016366223908918407, 'epoch': 3.11}
 19%|███████████████████▊                                                                                       | 390/2108 [1:46:50<7:53:20, 16.53s/it] 19%|███████████████████▊                                                                                       | 391/2108 [1:47:07<7:53:05, 16.53s/it] 19%|███████████████████▉                                                                                       | 392/2108 [1:47:23<7:52:50, 16.53s/it] 19%|███████████████████▉                                                                                       | 393/2108 [1:47:40<7:52:24, 16.53s/it] 19%|███████████████████▉                                                                                       | 394/2108 [1:47:56<7:52:01, 16.52s/it] 19%|████████████████████                                                                                       | 395/2108 [1:48:13<7:51:50, 16.53s/it] 19%|████████████████████                                                                                       | 396/2108 [1:48:29<7:51:28, 16.52s/it] 19%|████████████████████▏                                                                                      | 397/2108 [1:48:46<7:51:17, 16.53s/it] 19%|████████████████████▏                                                                                      | 398/2108 [1:49:03<7:51:04, 16.53s/it] 19%|████████████████████▎                                                                                      | 399/2108 [1:49:19<7:50:51, 16.53s/it] 19%|████████████████████▎                                                                                      | 400/2108 [1:49:36<7:50:36, 16.53s/it]                                                                                                                                                       {'loss': 1.2743, 'learning_rate': 0.0001627134724857685, 'epoch': 3.13}
 19%|████████████████████▎                                                                                      | 400/2108 [1:49:36<7:50:36, 16.53s/it]/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 19%|████████████████████▎                                                                                      | 401/2108 [1:49:53<7:57:31, 16.78s/it] 19%|████████████████████▍                                                                                      | 402/2108 [1:50:09<7:54:56, 16.70s/it] 19%|████████████████████▍                                                                                      | 403/2108 [1:50:26<7:53:13, 16.65s/it] 19%|████████████████████▌                                                                                      | 404/2108 [1:50:43<7:51:56, 16.62s/it] 19%|████████████████████▌                                                                                      | 405/2108 [1:50:59<7:50:46, 16.59s/it] 19%|████████████████████▌                                                                                      | 406/2108 [1:51:16<7:50:03, 16.57s/it] 19%|████████████████████▋                                                                                      | 407/2108 [1:51:32<7:49:28, 16.56s/it] 19%|████████████████████▋                                                                                      | 408/2108 [1:51:49<7:48:49, 16.55s/it] 19%|████████████████████▊                                                                                      | 409/2108 [1:52:05<7:48:27, 16.54s/it] 19%|████████████████████▊                                                                                      | 410/2108 [1:52:22<7:48:05, 16.54s/it]                                                                                                                                                       {'loss': 1.2642, 'learning_rate': 0.00016176470588235295, 'epoch': 3.15}
 19%|████████████████████▊                                                                                      | 410/2108 [1:52:22<7:48:05, 16.54s/it] 19%|████████████████████▊                                                                                      | 411/2108 [1:52:38<7:47:46, 16.54s/it] 20%|████████████████████▉                                                                                      | 412/2108 [1:52:55<7:47:27, 16.54s/it] 20%|████████████████████▉                                                                                      | 413/2108 [1:53:11<7:47:09, 16.54s/it] 20%|█████████████████████                                                                                      | 414/2108 [1:53:28<7:46:41, 16.53s/it] 20%|█████████████████████                                                                                      | 415/2108 [1:53:44<7:46:18, 16.53s/it] 20%|█████████████████████                                                                                      | 416/2108 [1:54:01<7:45:56, 16.52s/it] 20%|█████████████████████▏                                                                                     | 417/2108 [1:54:17<7:45:45, 16.53s/it] 20%|█████████████████████▏                                                                                     | 418/2108 [1:54:34<7:45:33, 16.53s/it] 20%|█████████████████████▎                                                                                     | 419/2108 [1:54:50<7:45:19, 16.53s/it] 20%|█████████████████████▎                                                                                     | 420/2108 [1:55:07<7:44:54, 16.53s/it]                                                                                                                                                       {'loss': 1.2254, 'learning_rate': 0.0001608159392789374, 'epoch': 3.17}
 20%|█████████████████████▎                                                                                     | 420/2108 [1:55:07<7:44:54, 16.53s/it] 20%|█████████████████████▎                                                                                     | 421/2108 [1:55:24<7:44:43, 16.53s/it] 20%|█████████████████████▍                                                                                     | 422/2108 [1:55:40<7:44:20, 16.52s/it] 20%|█████████████████████▍                                                                                     | 423/2108 [1:55:57<7:43:51, 16.52s/it] 20%|█████████████████████▌                                                                                     | 424/2108 [1:56:13<7:43:40, 16.52s/it] 20%|█████████████████████▌                                                                                     | 425/2108 [1:56:30<7:43:30, 16.52s/it] 20%|█████████████████████▌                                                                                     | 426/2108 [1:56:46<7:43:20, 16.53s/it] 20%|█████████████████████▋                                                                                     | 427/2108 [1:57:03<7:43:05, 16.53s/it] 20%|█████████████████████▋                                                                                     | 428/2108 [1:57:19<7:42:42, 16.53s/it] 20%|█████████████████████▊                                                                                     | 429/2108 [1:57:36<7:42:20, 16.52s/it] 20%|█████████████████████▊                                                                                     | 430/2108 [1:57:52<7:42:10, 16.53s/it]                                                                                                                                                       {'loss': 1.193, 'learning_rate': 0.0001599620493358634, 'epoch': 3.18}
 20%|█████████████████████▊                                                                                     | 430/2108 [1:57:52<7:42:10, 16.53s/it] 20%|█████████████████████▉                                                                                     | 431/2108 [1:58:09<7:41:48, 16.52s/it] 20%|█████████████████████▉                                                                                     | 432/2108 [1:58:25<7:41:28, 16.52s/it] 21%|█████████████████████▉                                                                                     | 433/2108 [1:58:42<7:41:19, 16.52s/it] 21%|██████████████████████                                                                                     | 434/2108 [1:58:58<7:41:06, 16.53s/it] 21%|██████████████████████                                                                                     | 435/2108 [1:59:15<7:40:27, 16.51s/it] 21%|██████████████████████▏                                                                                    | 436/2108 [1:59:31<7:40:17, 16.52s/it] 21%|██████████████████████▏                                                                                    | 437/2108 [1:59:48<7:40:00, 16.52s/it] 21%|██████████████████████▏                                                                                    | 438/2108 [2:00:04<7:39:52, 16.52s/it] 21%|██████████████████████▎                                                                                    | 439/2108 [2:00:21<7:39:41, 16.53s/it] 21%|██████████████████████▎                                                                                    | 440/2108 [2:00:37<7:39:30, 16.53s/it]                                                                                                                                                       {'loss': 1.2071, 'learning_rate': 0.00015910815939278937, 'epoch': 3.2}
 21%|██████████████████████▎                                                                                    | 440/2108 [2:00:37<7:39:30, 16.53s/it] 21%|██████████████████████▍                                                                                    | 441/2108 [2:00:54<7:39:05, 16.52s/it] 21%|██████████████████████▍                                                                                    | 442/2108 [2:01:10<7:38:44, 16.52s/it] 21%|██████████████████████▍                                                                                    | 443/2108 [2:01:27<7:38:34, 16.53s/it] 21%|██████████████████████▌                                                                                    | 444/2108 [2:01:29<5:38:07, 12.19s/it]                                                                                                                                                       {'train_runtime': 7289.6151, 'train_samples_per_second': 2.311, 'train_steps_per_second': 0.289, 'train_loss': 1.507242151208826, 'epoch': 3.21}
 21%|██████████████████████▌                                                                                    | 444/2108 [2:01:29<5:38:07, 12.19s/it] 21%|██████████████████████▌                                                                                    | 444/2108 [2:01:29<7:35:19, 16.42s/it]
Traceback (most recent call last):
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_errors.py", line 261, in hf_raise_for_status
    response.raise_for_status()
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/llama2-7b/resolve/main/adapter_config.json

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/utils/config.py", line 117, in from_pretrained
    config_file = hf_hub_download(
                  ^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1346, in hf_hub_download
    raise head_call_error
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1232, in hf_hub_download
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1608, in get_hf_file_metadata
    hf_raise_for_status(r)
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_errors.py", line 293, in hf_raise_for_status
    raise RepositoryNotFoundError(message, response) from e
huggingface_hub.utils._errors.RepositoryNotFoundError: 404 Client Error. (Request ID: Root=1-6644b54a-6840fc8b25f2a75a45f63925;36ac2e54-2b7b-4ffe-86c4-57c1619a354f)

Repository Not Found for url: https://huggingface.co/llama2-7b/resolve/main/adapter_config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aribra/llama2/domain_knowledge_finetuning.py", line 98, in <module>
    new_model = AutoPeftModelForCausalLM.from_pretrained(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/auto.py", line 69, in from_pretrained
    peft_config = PeftConfig.from_pretrained(pretrained_model_name_or_path, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/peft/utils/config.py", line 121, in from_pretrained
    raise ValueError(f"Can't find '{CONFIG_NAME}' at '{pretrained_model_name_or_path}'")
ValueError: Can't find 'adapter_config.json' at 'llama2-7b'
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ [K[K(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ 
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ 
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2[00m$ 