
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ 
[?2004l[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pythopn3^C[?2004l[?2004h[?2004l
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ python3 
domain_knowledge_eval_hf.py                      domain_knowledge_metrics_chkpnts.py
domain_knowledge_finetuning.py                   domain_knowledge_test_save_model.py
domain_knowledge_finetuning_cont.py              llama2-7b-coaxnn-paper/
domain_knowledge_metrics.py                      meta-llama2-7b-coaxnn-paper-domain-tuned-merged/
(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ python3 [7mdomain_knowledge_metrics_chkpnts.py[27mdomain_knowledge_metrics_chkpnts.py
[?2004lTest data:  Dataset({
    features: ['text'],
    num_rows: 400
}) [102  92  14 106  71  20 102 121  74  87 116  99 103 130  52   1  87  37
 129  20  57  21  88  48  58  14  50 107  54  63 130  50 134  20  72  17
 131  88  59  13   8  89  52 129  83  91 110   7  34  80  49 103 131   1
 133  53 105   3  53 145  43  13  94  47  14  39  81 110  52  23 123  40
  14  44  64  88  70   8  87 128 135  62 138  80 135  32 122   4  40  27
 134  71  11  32  47  61  36  98 103  34 100 130   0   4 141 102  26 136
  14  89  41 123  62  95  51  95 131 142  28  35  12  70  85  27  65  44
  61 133  27  27 107  43  83  29  74 127  91 128 120  26 120 115   2 102
 136  61  50  58 117  95 112  61  51  11  38 129 130 112 100 112  80 112
   1 129  53  86 128 125 129  52  67 122 144  37  23  68 115  97 138 143
  96 123  69  92   2  89  95  51 127  38  81 103 128  10  41  98   6 143
  89 111  59 112   1 128  47 139  36   8  98  47 130  53 119 115  74 112
 103  83 111  98  92 145 127 109  81  53  67  32 141  20  47 127 135 134
 144 127  32 114 118  21  37 108  50   7  26  26  20  29  96  27 110  60
  47   3  34  48  16  45 116   5  98 123  36  23  92  45  94  98 115  66
 127  17  24  53  57  66 103  23 113  31  85 126 129  16 103 136  42  38
  25  98  49  12  59 134  56  35  19  64   7 143 141 114 142  91  97  65
  31  85  50  62 124  57  57  85  48  69  14  53 100   7  52  59 107   4
 102   5 108 115  93  46  98  54  51 143  12 113 123 105 144 119  62  18
  91  57  89 116  61  22 126 136 139 128  57 121   0  33  95 125 117  47
  88 116 128  15  68  21  92  75 143  85  28  68  46  93 143  84  38  99
  32 100  22   9  68  99  33 137  95   0  68   3  15  23  79   1 127  83
 139 123  32 100]
tokenizer_config.json:   0%|                                                              | 0.00/1.71k [00:00<?, ?B/s]tokenizer_config.json: 100%|█████████████████████████████████████████████████████| 1.71k/1.71k [00:00<00:00, 13.5MB/s]
tokenizer.json:   0%|                                                                     | 0.00/1.84M [00:00<?, ?B/s]tokenizer.json: 100%|████████████████████████████████████████████████████████████| 1.84M/1.84M [00:00<00:00, 5.71MB/s]tokenizer.json: 100%|████████████████████████████████████████████████████████████| 1.84M/1.84M [00:00<00:00, 5.68MB/s]
special_tokens_map.json:   0%|                                                              | 0.00/437 [00:00<?, ?B/s]special_tokens_map.json: 100%|███████████████████████████████████████████████████████| 437/437 [00:00<00:00, 5.57MB/s]
Traceback (most recent call last):
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/hub.py", line 399, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 160, in validate_repo_id
    raise HFValidationError(
huggingface_hub.errors.HFValidationError: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: '/checkpoint-15'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aribra/llama2/paper/pretraining_paper/domain_knowledge_metrics_chkpnts.py", line 68, in <module>
    model = AutoModelForCausalLM.from_pretrained(chkpnt_path,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/models/auto/auto_factory.py", line 484, in from_pretrained
    resolved_config_file = cached_file(
                           ^^^^^^^^^^^^
  File "/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/transformers/utils/hub.py", line 463, in cached_file
    raise EnvironmentError(
OSError: Incorrect path_or_model_id: '/checkpoint-15'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ [Kpython3 domain_knowledge_metrics_chkpnts.py[Kpython3 domain_knowledge_metrics_chkpnts.py[22Pconda activate llama2cudaenv[1Pwatch -n 1 nvidia-smi[13Pdf -h ./watch -n 1 nvidia-smi[13Pdf -h ./watch -n 1 nvidia-smipython3 -m ipykernel install --user --name cuddaenv --display-name "Python (cudaenv)"[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ [10Pjupyter kernelspec uninstall llama2
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ jupyter kernelspec uninstall llama2cudaenvlist[K[14Pipykernel[13@pip3 install ipykerneljupyter kernelspec listpip3 install ctransformers"transformers==4.35" "datasets==22.13.0" "peft==0.4.0" "accelerate==0.21.0" "bitsandbytes==0.40.2" "trl==0.4.7" "safetensors>=0.3.1" "tiktoken"[A[23Pconda activate cudaenv
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ conda activate cudaenvpip install "transformers==4.35" "datasets==2..13.0" "peft==0.4.0" "accelerate==0.21.0" "bitsandbytes==0.40.2" "trl==0.4.7" "safetensors>=0.3.1" "tiktoken"[A[15Pconda create -n cudaenv python
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ conda create -n cudaenv pythonlean -a[Kca[Kenv listcreate -c https://conda.anaconda.org/nviidia/label/cuda-12.0.1 -n cudaenv cuda[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ conda env list[K
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ conda env listrm -rf /home/aribra/miniconda3/envs/cudaenvconda env list[Kdeactivateinstall cuda==12.0[2Plist | grep cuda[K[4@env listpython3 -m ipykernel install --user --name cuddaenv --display-name "Python (cudaenv)"[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ p[23Pip3 install ipykernel
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 install ipykernelython3 -m ipykernel install --user --name cuddaenv --display-name "Python (cudaenv)"[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ [23Pconda activate cudaenv
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ conda activate cudaenv[1Pwatch -n 1 nvidia-smi[13Pdf -h ./watch -n 1 nvidia-smipip3 install ctransformers --force-reinstall  [A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 uninstall ctransformers --force-reinstalll [A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 uninstall [18Ptransformers
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 uninstall transformersctransformers --force-reinstalll [A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 uninstall ctransformers[K
[K[A(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ pip3 uninstall ctransformers[7Pwatch -n 1 nvidia-smipip3 install ctransformers^C[?2004l[?2004h[?2004l
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ python3 domain_knowledge_metrics_chkpnts.py[22Pconda activate llama2cudaenv[1Pllama2python3 domain_knowledge_metrics_chkpnts.py
[?2004lTest data:  Dataset({
    features: ['text'],
    num_rows: 400
}) [102  92  14 106  71  20 102 121  74  87 116  99 103 130  52   1  87  37
 129  20  57  21  88  48  58  14  50 107  54  63 130  50 134  20  72  17
 131  88  59  13   8  89  52 129  83  91 110   7  34  80  49 103 131   1
 133  53 105   3  53 145  43  13  94  47  14  39  81 110  52  23 123  40
  14  44  64  88  70   8  87 128 135  62 138  80 135  32 122   4  40  27
 134  71  11  32  47  61  36  98 103  34 100 130   0   4 141 102  26 136
  14  89  41 123  62  95  51  95 131 142  28  35  12  70  85  27  65  44
  61 133  27  27 107  43  83  29  74 127  91 128 120  26 120 115   2 102
 136  61  50  58 117  95 112  61  51  11  38 129 130 112 100 112  80 112
   1 129  53  86 128 125 129  52  67 122 144  37  23  68 115  97 138 143
  96 123  69  92   2  89  95  51 127  38  81 103 128  10  41  98   6 143
  89 111  59 112   1 128  47 139  36   8  98  47 130  53 119 115  74 112
 103  83 111  98  92 145 127 109  81  53  67  32 141  20  47 127 135 134
 144 127  32 114 118  21  37 108  50   7  26  26  20  29  96  27 110  60
  47   3  34  48  16  45 116   5  98 123  36  23  92  45  94  98 115  66
 127  17  24  53  57  66 103  23 113  31  85 126 129  16 103 136  42  38
  25  98  49  12  59 134  56  35  19  64   7 143 141 114 142  91  97  65
  31  85  50  62 124  57  57  85  48  69  14  53 100   7  52  59 107   4
 102   5 108 115  93  46  98  54  51 143  12 113 123 105 144 119  62  18
  91  57  89 116  61  22 126 136 139 128  57 121   0  33  95 125 117  47
  88 116 128  15  68  21  92  75 143  85  28  68  46  93 143  84  38  99
  32 100  22   9  68  99  33 137  95   0  68   3  15  23  79   1 127  83
 139 123  32 100]
/home/aribra/miniconda3/envs/llama2/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.02s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  1.90s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.07s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:01<05:41,  1.75s/it]  1%|▊                                                                                | 2/196 [00:02<03:08,  1.03it/s]  2%|█▏                                                                               | 3/196 [00:02<02:21,  1.36it/s]  2%|█▋                                                                               | 4/196 [00:03<01:58,  1.62it/s]  3%|██                                                                               | 5/196 [00:03<01:46,  1.79it/s]  3%|██▍                                                                              | 6/196 [00:03<01:39,  1.92it/s]  4%|██▉                                                                              | 7/196 [00:04<01:33,  2.01it/s]  4%|███▎                                                                             | 8/196 [00:04<01:30,  2.07it/s]  5%|███▋                                                                             | 9/196 [00:05<01:27,  2.13it/s]  5%|████                                                                            | 10/196 [00:05<01:26,  2.15it/s]  6%|████▍                                                                           | 11/196 [00:06<01:24,  2.18it/s]  6%|████▉                                                                           | 12/196 [00:06<01:24,  2.18it/s]  7%|█████▎                                                                          | 13/196 [00:07<01:23,  2.20it/s]  7%|█████▋                                                                          | 14/196 [00:07<01:22,  2.20it/s]  8%|██████                                                                          | 15/196 [00:08<01:22,  2.21it/s]  8%|██████▌                                                                         | 16/196 [00:08<01:21,  2.21it/s]  9%|██████▉                                                                         | 17/196 [00:08<01:21,  2.21it/s]  9%|███████▎                                                                        | 18/196 [00:09<01:20,  2.21it/s] 10%|███████▊                                                                        | 19/196 [00:09<01:20,  2.21it/s] 10%|████████▏                                                                       | 20/196 [00:10<01:19,  2.21it/s] 11%|████████▌                                                                       | 21/196 [00:10<01:19,  2.21it/s] 11%|████████▉                                                                       | 22/196 [00:11<01:18,  2.21it/s] 12%|█████████▍                                                                      | 23/196 [00:11<01:18,  2.21it/s] 12%|█████████▊                                                                      | 24/196 [00:12<01:17,  2.21it/s] 13%|██████████▏                                                                     | 25/196 [00:12<01:17,  2.20it/s] 13%|██████████▌                                                                     | 26/196 [00:13<01:17,  2.21it/s] 14%|███████████                                                                     | 27/196 [00:13<01:16,  2.20it/s] 14%|███████████▍                                                                    | 28/196 [00:13<01:16,  2.20it/s] 15%|███████████▊                                                                    | 29/196 [00:14<01:15,  2.20it/s] 15%|████████████▏                                                                   | 30/196 [00:14<01:15,  2.20it/s] 16%|████████████▋                                                                   | 31/196 [00:15<01:15,  2.20it/s] 16%|█████████████                                                                   | 32/196 [00:15<01:14,  2.19it/s] 17%|█████████████▍                                                                  | 33/196 [00:16<01:14,  2.19it/s] 17%|█████████████▉                                                                  | 34/196 [00:16<01:14,  2.19it/s] 18%|██████████████▎                                                                 | 35/196 [00:17<01:13,  2.19it/s] 18%|██████████████▋                                                                 | 36/196 [00:17<01:13,  2.18it/s] 19%|███████████████                                                                 | 37/196 [00:18<01:12,  2.18it/s] 19%|███████████████▌                                                                | 38/196 [00:18<01:12,  2.18it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:12,  2.17it/s] 20%|████████████████▎                                                               | 40/196 [00:19<01:11,  2.17it/s] 21%|████████████████▋                                                               | 41/196 [00:19<01:11,  2.17it/s] 21%|█████████████████▏                                                              | 42/196 [00:20<01:11,  2.17it/s] 22%|█████████████████▌                                                              | 43/196 [00:20<01:10,  2.17it/s] 22%|█████████████████▉                                                              | 44/196 [00:21<01:10,  2.17it/s] 23%|██████████████████▎                                                             | 45/196 [00:21<01:09,  2.16it/s] 23%|██████████████████▊                                                             | 46/196 [00:22<01:09,  2.16it/s] 24%|███████████████████▏                                                            | 47/196 [00:22<01:09,  2.16it/s] 24%|███████████████████▌                                                            | 48/196 [00:23<01:08,  2.16it/s] 25%|████████████████████                                                            | 49/196 [00:23<01:08,  2.15it/s] 26%|████████████████████▍                                                           | 50/196 [00:24<01:07,  2.15it/s] 26%|████████████████████▊                                                           | 51/196 [00:24<01:07,  2.15it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:07,  2.15it/s] 27%|█████████████████████▋                                                          | 53/196 [00:25<01:06,  2.14it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:06,  2.14it/s] 28%|██████████████████████▍                                                         | 55/196 [00:26<01:05,  2.14it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:05,  2.14it/s] 29%|███████████████████████▎                                                        | 57/196 [00:27<01:05,  2.13it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:04,  2.13it/s] 30%|████████████████████████                                                        | 59/196 [00:28<01:04,  2.13it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:03,  2.13it/s] 31%|████████████████████████▉                                                       | 61/196 [00:29<01:03,  2.12it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:03,  2.12it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:30<01:02,  2.12it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:02,  2.12it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:31<01:02,  2.11it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:01,  2.11it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:32<01:01,  2.11it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:00,  2.10it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:33<01:00,  2.10it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:00,  2.09it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<00:59,  2.09it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<00:59,  2.09it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<00:59,  2.08it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:58,  2.09it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:58,  2.09it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:57,  2.08it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:57,  2.08it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:56,  2.10it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:55,  2.11it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:38<00:55,  2.11it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:54,  2.11it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:39<00:54,  2.10it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:53,  2.11it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:40<00:53,  2.11it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:52,  2.11it/s] 44%|███████████████████████████████████                                             | 86/196 [00:41<00:52,  2.11it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:51,  2.11it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:42<00:51,  2.10it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:50,  2.10it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:43<00:50,  2.10it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:49,  2.10it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:49,  2.10it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.10it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:48,  2.10it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.10it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:47,  2.10it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.10it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:46,  2.10it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.10it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:45,  2.10it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.10it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:44,  2.10it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.10it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:43,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:42,  2.10it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:51<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:52<00:41,  2.09it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:53<00:40,  2.09it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.09it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.10it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.10it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.10it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.11it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:34,  2.11it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.11it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [01:00<00:33,  2.11it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:01<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:02<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.12it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.12it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.12it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.13it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:08<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:09<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:10<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.14it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:15<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:16<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.16it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.16it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.16it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.16it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:22<00:10,  2.17it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.17it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.17it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.17it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.17it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.17it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.17it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.17it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.17it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.17it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:05,  2.17it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.18it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.18it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:28<00:04,  2.18it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.18it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.18it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.19it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.18it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.18it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.18it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.18it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.18it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.10it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-15]: ppl =  tensor(5.5560, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.49s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.32it/s]  1%|▊                                                                                | 2/196 [00:00<01:07,  2.86it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.49it/s]  2%|█▋                                                                               | 4/196 [00:01<01:20,  2.37it/s]  3%|██                                                                               | 5/196 [00:02<01:22,  2.31it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.26it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.24it/s]  4%|███▎                                                                             | 8/196 [00:03<01:24,  2.22it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.21it/s]  5%|████                                                                            | 10/196 [00:04<01:24,  2.19it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.20it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.18it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:23,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.17it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.18it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.17it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.17it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.17it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:21,  2.16it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.16it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.16it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:20,  2.16it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.15it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:19,  2.15it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:19,  2.15it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.15it/s] 14%|███████████                                                                     | 27/196 [00:12<01:18,  2.14it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:18,  2.14it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.14it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:17,  2.13it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:17,  2.13it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.13it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:16,  2.12it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.12it/s] 18%|██████████████▎                                                                 | 35/196 [00:15<01:16,  2.12it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:15,  2.11it/s] 19%|███████████████                                                                 | 37/196 [00:16<01:15,  2.11it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:14,  2.11it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:14,  2.11it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.10it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:13,  2.10it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.09it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.09it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:12,  2.09it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:11,  2.08it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:11,  2.08it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.08it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:10,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.07it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.07it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.07it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.07it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:07,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.06it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.06it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.06it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:03,  2.05it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:30<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.05it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:31<01:02,  2.05it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.05it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:32<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:33<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:34<00:59,  2.04it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:35<00:58,  2.04it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.04it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.04it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.04it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:55,  2.05it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.05it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:54,  2.05it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.05it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:53,  2.05it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.06it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.07it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.07it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:47<00:45,  2.07it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.07it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:48<00:44,  2.07it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.07it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:49<00:43,  2.08it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.08it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.08it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.08it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.08it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.08it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.09it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.09it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.10it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.10it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.09it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.09it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.10it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.10it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.10it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:58<00:34,  2.11it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.11it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.11it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.11it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:32,  2.11it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.12it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.12it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.12it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.12it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.12it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.12it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.12it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.12it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.13it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.13it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:06<00:25,  2.13it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.13it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.13it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.13it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.13it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.13it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.13it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.13it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:22,  2.13it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:21,  2.13it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.14it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.14it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.14it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.14it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.14it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.14it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.14it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.14it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:13,  2.15it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.16it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.15it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-30]: ppl =  tensor(4.8751, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.30s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.08s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.26s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<01:41,  1.92it/s]  1%|▊                                                                                | 2/196 [00:00<01:08,  2.85it/s]  2%|█▏                                                                               | 3/196 [00:01<01:15,  2.57it/s]  2%|█▋                                                                               | 4/196 [00:01<01:20,  2.38it/s]  3%|██                                                                               | 5/196 [00:02<01:22,  2.32it/s]  3%|██▍                                                                              | 6/196 [00:02<01:23,  2.27it/s]  4%|██▉                                                                              | 7/196 [00:03<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:24,  2.22it/s]  5%|███▋                                                                             | 9/196 [00:03<01:25,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:24,  2.20it/s]  6%|████▍                                                                           | 11/196 [00:04<01:25,  2.18it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.19it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.17it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.18it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:22,  2.17it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:09<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.14it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:18,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:17,  2.12it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.09it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.09it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:14,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.07it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.06it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:09,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.04it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.04it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.04it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.04it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:38<00:56,  2.04it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:55,  2.05it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.05it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.07it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.07it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.07it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.08it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.08it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:51<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:52<00:41,  2.09it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.09it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.09it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.09it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.09it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.10it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.10it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.10it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.10it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:34,  2.11it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.11it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [01:00<00:33,  2.11it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.11it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:01<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.12it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.12it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.13it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.13it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.13it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.13it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.13it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:08<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:09<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.14it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:21,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:15<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.15it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:22<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.16it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.16it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.16it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.16it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:28<00:04,  2.16it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.16it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.10it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-45]: ppl =  tensor(4.3396, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.28it/s]  1%|▊                                                                                | 2/196 [00:00<01:07,  2.87it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.49it/s]  2%|█▋                                                                               | 4/196 [00:01<01:20,  2.37it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.30it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.21it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.21it/s]  5%|████                                                                            | 10/196 [00:04<01:24,  2.19it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:23,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.17it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.18it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:20,  2.15it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:19,  2.14it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.14it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:18,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.12it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:16<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.08it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:11,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.07it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.07it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.07it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.06it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:06,  2.06it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:05,  2.04it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.05it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.05it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:34<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:35<00:58,  2.04it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.04it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:55,  2.05it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.05it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:54,  2.05it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.05it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.06it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.06it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.06it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.07it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.08it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.08it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.08it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.08it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.09it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.10it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.10it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.11it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:34,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.13it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.13it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.13it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.14it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:21,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.16it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.16it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.16it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.16it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.16it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.16it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.16it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.16it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-60]: ppl =  tensor(3.8301, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.39s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.16s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.34s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.30it/s]  1%|▊                                                                                | 2/196 [00:00<01:07,  2.86it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.48it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.36it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.29it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.21it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:23,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.17it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:23,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.15it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.15it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.14it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:18,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.13it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:17,  2.12it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:15,  2.11it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:14,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.09it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:14,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.06it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.05it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.05it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:34<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.05it/s] 39%|███████████████████████████████                                                 | 76/196 [00:35<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.07it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.08it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.08it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.08it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.08it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:49<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.08it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.10it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:40,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.10it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.11it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:58<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.14it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.14it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.14it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:06<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.15it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.15it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:13<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.16it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.16it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:13,  2.15it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:19<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.16it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.16it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.16it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:26<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.16it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.16it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.16it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.15it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.16it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.16it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-75]: ppl =  tensor(3.4615, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.27s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.10s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<01:25,  2.29it/s]  1%|▊                                                                                | 2/196 [00:00<01:09,  2.80it/s]  2%|█▏                                                                               | 3/196 [00:01<01:15,  2.55it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.36it/s]  3%|██                                                                               | 5/196 [00:02<01:22,  2.31it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:03<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.21it/s]  5%|███▋                                                                             | 9/196 [00:03<01:25,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:24,  2.19it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.18it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.18it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.17it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.17it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.16it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.17it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:09<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.14it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:18,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.13it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.11it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.11it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:17,  2.10it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.10it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.09it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.08it/s] 21%|████████████████▋                                                               | 41/196 [00:19<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:11,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.06it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:09,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.05it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:06,  2.04it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:03,  2.05it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.05it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.05it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.05it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:38<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.07it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.08it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.08it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.08it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.09it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:44,  2.09it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.09it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:42,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:51<00:42,  2.10it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:41,  2.10it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.10it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:40,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:36,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.12it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:35,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.12it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:31,  2.13it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.13it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.13it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.14it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.16it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.15it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-90]: ppl =  tensor(3.1854, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.48s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.30it/s]  1%|▊                                                                                | 2/196 [00:00<01:08,  2.85it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.48it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.36it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.29it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.20it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:24,  2.16it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.14it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.12it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.11it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:14,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.06it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.06it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.06it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:07,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.06it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:03,  2.05it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.05it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.05it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.05it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.05it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.05it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.04it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:35<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:54,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.07it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.09it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.09it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:43,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:49<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.10it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:36,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.11it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:35,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.12it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.13it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.13it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.14it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:06<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.14it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:13<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:13,  2.15it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.16it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:26<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.16it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-105]: ppl =  tensor(2.9590, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.40s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.14s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.33s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.33it/s]  1%|▊                                                                                | 2/196 [00:00<01:07,  2.86it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.48it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.37it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.29it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.20it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.17it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:24,  2.16it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.15it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.15it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:17,  2.12it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.12it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:14,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.08it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.08it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:11,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.07it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.05it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.06it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.06it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.05it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.05it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:02,  2.05it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.05it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:01,  2.05it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.05it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.05it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.05it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.05it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:34<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.05it/s] 39%|███████████████████████████████                                                 | 76/196 [00:35<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:56,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.07it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.07it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.07it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.07it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.08it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.08it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.08it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.08it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.08it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.08it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.09it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:44,  2.09it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:48<00:44,  2.09it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:49<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.10it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:40,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.11it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:37,  2.12it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.12it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:36,  2.12it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.12it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:35,  2.12it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.12it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:57<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:58<00:33,  2.13it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.13it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:32,  2.13it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.13it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:31,  2.13it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.13it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.13it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:29,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.14it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.14it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.14it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.14it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:05<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:06<00:25,  2.15it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.15it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.15it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.15it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.15it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:12<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:13<00:18,  2.16it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.16it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.16it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.16it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.16it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.16it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.16it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:18<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:19<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.16it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.16it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:26<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.16it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.16it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.16it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.16it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.16it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.16it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-120]: ppl =  tensor(2.7482, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.31s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.29s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.30it/s]  1%|▊                                                                                | 2/196 [00:00<01:08,  2.85it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.49it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.37it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.30it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.21it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:23,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:23,  2.17it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.14it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.12it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.11it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.10it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:17,  2.10it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.10it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.09it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:17<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.07it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.06it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.06it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.06it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:10,  2.05it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.05it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.05it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:05,  2.04it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.04it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.05it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:36<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.05it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:54,  2.05it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.07it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.08it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.08it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.08it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.09it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.11it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:34,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.12it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.13it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.13it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.14it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:21,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.14it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.16it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.16it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.16it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-135]: ppl =  tensor(2.6448, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.30s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.25s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<01:12,  2.70it/s]  1%|▊                                                                                | 2/196 [00:00<01:19,  2.45it/s]  2%|█▏                                                                               | 3/196 [00:01<01:23,  2.30it/s]  2%|█▋                                                                               | 4/196 [00:01<01:24,  2.26it/s]  3%|██                                                                               | 5/196 [00:02<01:25,  2.23it/s]  3%|██▍                                                                              | 6/196 [00:02<01:26,  2.21it/s]  4%|██▉                                                                              | 7/196 [00:03<01:25,  2.21it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.19it/s]  5%|███▋                                                                             | 9/196 [00:04<01:25,  2.19it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.18it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.17it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:24,  2.16it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.17it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.16it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:09<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.15it/s] 11%|████████▉                                                                       | 22/196 [00:10<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:20,  2.14it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.14it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.13it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.13it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:17,  2.12it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.12it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.11it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.11it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.10it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:19<01:14,  2.09it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:20<01:13,  2.07it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.07it/s] 23%|██████████████████▎                                                             | 45/196 [00:21<01:12,  2.07it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:11,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.06it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.07it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:08,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.05it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.05it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.05it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.05it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.05it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.04it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:38<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:39<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:40<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.08it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.08it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.08it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.08it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.09it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.09it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.09it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:51<00:42,  2.09it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:52<00:41,  2.09it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.09it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.11it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:36,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.11it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:35,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.12it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.11it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:34,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [01:00<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:01<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.13it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.14it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.14it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:08<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.15it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.15it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:15<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.16it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.15it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.16it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.16it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.16it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:28<00:04,  2.16it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.16it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.16it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.16it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.10it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-150]: ppl =  tensor(2.5469, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.30it/s]  1%|▊                                                                                | 2/196 [00:00<01:08,  2.84it/s]  2%|█▏                                                                               | 3/196 [00:01<01:17,  2.48it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.35it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.29it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.24it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.20it/s]  5%|███▋                                                                             | 9/196 [00:03<01:24,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.19it/s]  6%|████▉                                                                           | 12/196 [00:05<01:24,  2.17it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.18it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:24,  2.16it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.16it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.15it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:23,  2.15it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.15it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.14it/s] 10%|████████▏                                                                       | 20/196 [00:09<01:22,  2.14it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.14it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:21,  2.13it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.13it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.12it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.12it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.12it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.11it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.10it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.09it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.09it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:15,  2.08it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:15,  2.08it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.08it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:14,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.07it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.07it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.06it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.06it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.05it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:09,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.05it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.05it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:05,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.05it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.04it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.05it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.05it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.05it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.05it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:56,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.06it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:52,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.07it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.07it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.08it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.08it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.08it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.08it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.08it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.08it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.08it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.08it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.09it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.09it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.09it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:50<00:42,  2.10it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:41,  2.10it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:51<00:41,  2.10it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.10it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.10it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.11it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:36,  2.11it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.11it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:35,  2.11it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.11it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.12it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.12it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [00:59<00:33,  2.12it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.13it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:00<00:31,  2.13it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.13it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.13it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.14it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.14it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:07<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.15it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.15it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.15it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.15it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.15it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:14<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.15it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.16it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:20<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:21<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.15it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.15it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:27<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.15it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.11it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-165]: ppl =  tensor(2.4975, device='cuda:0')



Loading checkpoint shards:   0%|                                                                | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|████████████████████████████                            | 1/2 [00:03<00:03,  3.34s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.12s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it]
You are calling `save_pretrained` to a 4-bit converted model, but your `bitsandbytes` version doesn't support it. If you want to save 4-bit models, make sure to have `bitsandbytes>=0.41.3` installed.
max_length:  1024
  0%|                                                                                         | 0/196 [00:00<?, ?it/s]  1%|▍                                                                                | 1/196 [00:00<00:45,  4.31it/s]  1%|▊                                                                                | 2/196 [00:00<01:08,  2.85it/s]  2%|█▏                                                                               | 3/196 [00:01<01:18,  2.47it/s]  2%|█▋                                                                               | 4/196 [00:01<01:21,  2.36it/s]  3%|██                                                                               | 5/196 [00:02<01:23,  2.29it/s]  3%|██▍                                                                              | 6/196 [00:02<01:24,  2.25it/s]  4%|██▉                                                                              | 7/196 [00:02<01:24,  2.23it/s]  4%|███▎                                                                             | 8/196 [00:03<01:25,  2.20it/s]  5%|███▋                                                                             | 9/196 [00:03<01:25,  2.20it/s]  5%|████                                                                            | 10/196 [00:04<01:25,  2.18it/s]  6%|████▍                                                                           | 11/196 [00:04<01:24,  2.18it/s]  6%|████▉                                                                           | 12/196 [00:05<01:25,  2.16it/s]  7%|█████▎                                                                          | 13/196 [00:05<01:24,  2.17it/s]  7%|█████▋                                                                          | 14/196 [00:06<01:24,  2.16it/s]  8%|██████                                                                          | 15/196 [00:06<01:23,  2.16it/s]  8%|██████▌                                                                         | 16/196 [00:07<01:23,  2.16it/s]  9%|██████▉                                                                         | 17/196 [00:07<01:22,  2.16it/s]  9%|███████▎                                                                        | 18/196 [00:08<01:22,  2.15it/s] 10%|███████▊                                                                        | 19/196 [00:08<01:22,  2.15it/s] 10%|████████▏                                                                       | 20/196 [00:08<01:21,  2.15it/s] 11%|████████▌                                                                       | 21/196 [00:09<01:21,  2.14it/s] 11%|████████▉                                                                       | 22/196 [00:09<01:21,  2.14it/s] 12%|█████████▍                                                                      | 23/196 [00:10<01:21,  2.13it/s] 12%|█████████▊                                                                      | 24/196 [00:10<01:20,  2.13it/s] 13%|██████████▏                                                                     | 25/196 [00:11<01:20,  2.13it/s] 13%|██████████▌                                                                     | 26/196 [00:11<01:19,  2.13it/s] 14%|███████████                                                                     | 27/196 [00:12<01:19,  2.12it/s] 14%|███████████▍                                                                    | 28/196 [00:12<01:19,  2.12it/s] 15%|███████████▊                                                                    | 29/196 [00:13<01:18,  2.12it/s] 15%|████████████▏                                                                   | 30/196 [00:13<01:18,  2.11it/s] 16%|████████████▋                                                                   | 31/196 [00:14<01:18,  2.11it/s] 16%|█████████████                                                                   | 32/196 [00:14<01:17,  2.11it/s] 17%|█████████████▍                                                                  | 33/196 [00:15<01:17,  2.11it/s] 17%|█████████████▉                                                                  | 34/196 [00:15<01:16,  2.11it/s] 18%|██████████████▎                                                                 | 35/196 [00:16<01:16,  2.10it/s] 18%|██████████████▋                                                                 | 36/196 [00:16<01:16,  2.10it/s] 19%|███████████████                                                                 | 37/196 [00:17<01:15,  2.10it/s] 19%|███████████████▌                                                                | 38/196 [00:17<01:15,  2.10it/s] 20%|███████████████▉                                                                | 39/196 [00:18<01:15,  2.09it/s] 20%|████████████████▎                                                               | 40/196 [00:18<01:14,  2.09it/s] 21%|████████████████▋                                                               | 41/196 [00:18<01:14,  2.09it/s] 21%|█████████████████▏                                                              | 42/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▌                                                              | 43/196 [00:19<01:13,  2.08it/s] 22%|█████████████████▉                                                              | 44/196 [00:20<01:13,  2.08it/s] 23%|██████████████████▎                                                             | 45/196 [00:20<01:12,  2.07it/s] 23%|██████████████████▊                                                             | 46/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▏                                                            | 47/196 [00:21<01:12,  2.07it/s] 24%|███████████████████▌                                                            | 48/196 [00:22<01:11,  2.07it/s] 25%|████████████████████                                                            | 49/196 [00:22<01:11,  2.07it/s] 26%|████████████████████▍                                                           | 50/196 [00:23<01:10,  2.07it/s] 26%|████████████████████▊                                                           | 51/196 [00:23<01:10,  2.06it/s] 27%|█████████████████████▏                                                          | 52/196 [00:24<01:09,  2.06it/s] 27%|█████████████████████▋                                                          | 53/196 [00:24<01:09,  2.06it/s] 28%|██████████████████████                                                          | 54/196 [00:25<01:09,  2.06it/s] 28%|██████████████████████▍                                                         | 55/196 [00:25<01:08,  2.05it/s] 29%|██████████████████████▊                                                         | 56/196 [00:26<01:08,  2.05it/s] 29%|███████████████████████▎                                                        | 57/196 [00:26<01:07,  2.05it/s] 30%|███████████████████████▋                                                        | 58/196 [00:27<01:07,  2.05it/s] 30%|████████████████████████                                                        | 59/196 [00:27<01:06,  2.05it/s] 31%|████████████████████████▍                                                       | 60/196 [00:28<01:06,  2.05it/s] 31%|████████████████████████▉                                                       | 61/196 [00:28<01:05,  2.05it/s] 32%|█████████████████████████▎                                                      | 62/196 [00:29<01:05,  2.05it/s] 32%|█████████████████████████▋                                                      | 63/196 [00:29<01:04,  2.05it/s] 33%|██████████████████████████                                                      | 64/196 [00:30<01:04,  2.04it/s] 33%|██████████████████████████▌                                                     | 65/196 [00:30<01:04,  2.04it/s] 34%|██████████████████████████▉                                                     | 66/196 [00:31<01:03,  2.05it/s] 34%|███████████████████████████▎                                                    | 67/196 [00:31<01:03,  2.04it/s] 35%|███████████████████████████▊                                                    | 68/196 [00:32<01:02,  2.04it/s] 35%|████████████████████████████▏                                                   | 69/196 [00:32<01:02,  2.04it/s] 36%|████████████████████████████▌                                                   | 70/196 [00:33<01:01,  2.04it/s] 36%|████████████████████████████▉                                                   | 71/196 [00:33<01:01,  2.04it/s] 37%|█████████████████████████████▍                                                  | 72/196 [00:34<01:00,  2.04it/s] 37%|█████████████████████████████▊                                                  | 73/196 [00:34<01:00,  2.04it/s] 38%|██████████████████████████████▏                                                 | 74/196 [00:35<00:59,  2.04it/s] 38%|██████████████████████████████▌                                                 | 75/196 [00:35<00:59,  2.04it/s] 39%|███████████████████████████████                                                 | 76/196 [00:36<00:58,  2.04it/s] 39%|███████████████████████████████▍                                                | 77/196 [00:36<00:58,  2.04it/s] 40%|███████████████████████████████▊                                                | 78/196 [00:37<00:57,  2.05it/s] 40%|████████████████████████████████▏                                               | 79/196 [00:37<00:57,  2.05it/s] 41%|████████████████████████████████▋                                               | 80/196 [00:37<00:56,  2.05it/s] 41%|█████████████████████████████████                                               | 81/196 [00:38<00:56,  2.05it/s] 42%|█████████████████████████████████▍                                              | 82/196 [00:38<00:55,  2.05it/s] 42%|█████████████████████████████████▉                                              | 83/196 [00:39<00:55,  2.05it/s] 43%|██████████████████████████████████▎                                             | 84/196 [00:39<00:54,  2.06it/s] 43%|██████████████████████████████████▋                                             | 85/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████                                             | 86/196 [00:40<00:53,  2.06it/s] 44%|███████████████████████████████████▌                                            | 87/196 [00:41<00:53,  2.06it/s] 45%|███████████████████████████████████▉                                            | 88/196 [00:41<00:52,  2.06it/s] 45%|████████████████████████████████████▎                                           | 89/196 [00:42<00:51,  2.06it/s] 46%|████████████████████████████████████▋                                           | 90/196 [00:42<00:51,  2.06it/s] 46%|█████████████████████████████████████▏                                          | 91/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▌                                          | 92/196 [00:43<00:50,  2.06it/s] 47%|█████████████████████████████████████▉                                          | 93/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▎                                         | 94/196 [00:44<00:49,  2.07it/s] 48%|██████████████████████████████████████▊                                         | 95/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▏                                        | 96/196 [00:45<00:48,  2.07it/s] 49%|███████████████████████████████████████▌                                        | 97/196 [00:46<00:47,  2.07it/s] 50%|████████████████████████████████████████                                        | 98/196 [00:46<00:47,  2.07it/s] 51%|████████████████████████████████████████▍                                       | 99/196 [00:47<00:46,  2.07it/s] 51%|████████████████████████████████████████▎                                      | 100/196 [00:47<00:46,  2.07it/s] 52%|████████████████████████████████████████▋                                      | 101/196 [00:48<00:45,  2.07it/s] 52%|█████████████████████████████████████████                                      | 102/196 [00:48<00:45,  2.07it/s] 53%|█████████████████████████████████████████▌                                     | 103/196 [00:49<00:44,  2.08it/s] 53%|█████████████████████████████████████████▉                                     | 104/196 [00:49<00:44,  2.08it/s] 54%|██████████████████████████████████████████▎                                    | 105/196 [00:50<00:43,  2.08it/s] 54%|██████████████████████████████████████████▋                                    | 106/196 [00:50<00:43,  2.08it/s] 55%|███████████████████████████████████████████▏                                   | 107/196 [00:51<00:42,  2.08it/s] 55%|███████████████████████████████████████████▌                                   | 108/196 [00:51<00:42,  2.09it/s] 56%|███████████████████████████████████████████▉                                   | 109/196 [00:52<00:41,  2.08it/s] 56%|████████████████████████████████████████████▎                                  | 110/196 [00:52<00:41,  2.09it/s] 57%|████████████████████████████████████████████▋                                  | 111/196 [00:52<00:40,  2.09it/s] 57%|█████████████████████████████████████████████▏                                 | 112/196 [00:53<00:40,  2.10it/s] 58%|█████████████████████████████████████████████▌                                 | 113/196 [00:53<00:39,  2.10it/s] 58%|█████████████████████████████████████████████▉                                 | 114/196 [00:54<00:39,  2.10it/s] 59%|██████████████████████████████████████████████▎                                | 115/196 [00:54<00:38,  2.10it/s] 59%|██████████████████████████████████████████████▊                                | 116/196 [00:55<00:38,  2.10it/s] 60%|███████████████████████████████████████████████▏                               | 117/196 [00:55<00:37,  2.10it/s] 60%|███████████████████████████████████████████████▌                               | 118/196 [00:56<00:37,  2.10it/s] 61%|███████████████████████████████████████████████▉                               | 119/196 [00:56<00:36,  2.10it/s] 61%|████████████████████████████████████████████████▎                              | 120/196 [00:57<00:36,  2.10it/s] 62%|████████████████████████████████████████████████▊                              | 121/196 [00:57<00:35,  2.10it/s] 62%|█████████████████████████████████████████████████▏                             | 122/196 [00:58<00:35,  2.11it/s] 63%|█████████████████████████████████████████████████▌                             | 123/196 [00:58<00:34,  2.11it/s] 63%|█████████████████████████████████████████████████▉                             | 124/196 [00:59<00:34,  2.11it/s] 64%|██████████████████████████████████████████████████▍                            | 125/196 [00:59<00:33,  2.11it/s] 64%|██████████████████████████████████████████████████▊                            | 126/196 [01:00<00:33,  2.11it/s] 65%|███████████████████████████████████████████████████▏                           | 127/196 [01:00<00:32,  2.12it/s] 65%|███████████████████████████████████████████████████▌                           | 128/196 [01:01<00:32,  2.12it/s] 66%|███████████████████████████████████████████████████▉                           | 129/196 [01:01<00:31,  2.12it/s] 66%|████████████████████████████████████████████████████▍                          | 130/196 [01:01<00:31,  2.12it/s] 67%|████████████████████████████████████████████████████▊                          | 131/196 [01:02<00:30,  2.12it/s] 67%|█████████████████████████████████████████████████████▏                         | 132/196 [01:02<00:30,  2.13it/s] 68%|█████████████████████████████████████████████████████▌                         | 133/196 [01:03<00:29,  2.13it/s] 68%|██████████████████████████████████████████████████████                         | 134/196 [01:03<00:29,  2.13it/s] 69%|██████████████████████████████████████████████████████▍                        | 135/196 [01:04<00:28,  2.13it/s] 69%|██████████████████████████████████████████████████████▊                        | 136/196 [01:04<00:28,  2.13it/s] 70%|███████████████████████████████████████████████████████▏                       | 137/196 [01:05<00:27,  2.13it/s] 70%|███████████████████████████████████████████████████████▌                       | 138/196 [01:05<00:27,  2.13it/s] 71%|████████████████████████████████████████████████████████                       | 139/196 [01:06<00:26,  2.13it/s] 71%|████████████████████████████████████████████████████████▍                      | 140/196 [01:06<00:26,  2.14it/s] 72%|████████████████████████████████████████████████████████▊                      | 141/196 [01:07<00:25,  2.14it/s] 72%|█████████████████████████████████████████████████████████▏                     | 142/196 [01:07<00:25,  2.14it/s] 73%|█████████████████████████████████████████████████████████▋                     | 143/196 [01:08<00:24,  2.14it/s] 73%|██████████████████████████████████████████████████████████                     | 144/196 [01:08<00:24,  2.14it/s] 74%|██████████████████████████████████████████████████████████▍                    | 145/196 [01:08<00:23,  2.14it/s] 74%|██████████████████████████████████████████████████████████▊                    | 146/196 [01:09<00:23,  2.14it/s] 75%|███████████████████████████████████████████████████████████▎                   | 147/196 [01:09<00:22,  2.14it/s] 76%|███████████████████████████████████████████████████████████▋                   | 148/196 [01:10<00:22,  2.14it/s] 76%|████████████████████████████████████████████████████████████                   | 149/196 [01:10<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▍                  | 150/196 [01:11<00:21,  2.14it/s] 77%|████████████████████████████████████████████████████████████▊                  | 151/196 [01:11<00:20,  2.14it/s] 78%|█████████████████████████████████████████████████████████████▎                 | 152/196 [01:12<00:20,  2.15it/s] 78%|█████████████████████████████████████████████████████████████▋                 | 153/196 [01:12<00:20,  2.15it/s] 79%|██████████████████████████████████████████████████████████████                 | 154/196 [01:13<00:19,  2.15it/s] 79%|██████████████████████████████████████████████████████████████▍                | 155/196 [01:13<00:19,  2.14it/s] 80%|██████████████████████████████████████████████████████████████▉                | 156/196 [01:14<00:18,  2.15it/s] 80%|███████████████████████████████████████████████████████████████▎               | 157/196 [01:14<00:18,  2.15it/s] 81%|███████████████████████████████████████████████████████████████▋               | 158/196 [01:15<00:17,  2.15it/s] 81%|████████████████████████████████████████████████████████████████               | 159/196 [01:15<00:17,  2.14it/s] 82%|████████████████████████████████████████████████████████████████▍              | 160/196 [01:15<00:16,  2.14it/s] 82%|████████████████████████████████████████████████████████████████▉              | 161/196 [01:16<00:16,  2.14it/s] 83%|█████████████████████████████████████████████████████████████████▎             | 162/196 [01:16<00:15,  2.15it/s] 83%|█████████████████████████████████████████████████████████████████▋             | 163/196 [01:17<00:15,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████             | 164/196 [01:17<00:14,  2.15it/s] 84%|██████████████████████████████████████████████████████████████████▌            | 165/196 [01:18<00:14,  2.15it/s] 85%|██████████████████████████████████████████████████████████████████▉            | 166/196 [01:18<00:13,  2.15it/s] 85%|███████████████████████████████████████████████████████████████████▎           | 167/196 [01:19<00:13,  2.15it/s] 86%|███████████████████████████████████████████████████████████████████▋           | 168/196 [01:19<00:12,  2.16it/s] 86%|████████████████████████████████████████████████████████████████████           | 169/196 [01:20<00:12,  2.15it/s] 87%|████████████████████████████████████████████████████████████████████▌          | 170/196 [01:20<00:12,  2.16it/s] 87%|████████████████████████████████████████████████████████████████████▉          | 171/196 [01:21<00:11,  2.15it/s] 88%|█████████████████████████████████████████████████████████████████████▎         | 172/196 [01:21<00:11,  2.16it/s] 88%|█████████████████████████████████████████████████████████████████████▋         | 173/196 [01:22<00:10,  2.15it/s] 89%|██████████████████████████████████████████████████████████████████████▏        | 174/196 [01:22<00:10,  2.16it/s] 89%|██████████████████████████████████████████████████████████████████████▌        | 175/196 [01:22<00:09,  2.16it/s] 90%|██████████████████████████████████████████████████████████████████████▉        | 176/196 [01:23<00:09,  2.16it/s] 90%|███████████████████████████████████████████████████████████████████████▎       | 177/196 [01:23<00:08,  2.15it/s] 91%|███████████████████████████████████████████████████████████████████████▋       | 178/196 [01:24<00:08,  2.15it/s] 91%|████████████████████████████████████████████████████████████████████████▏      | 179/196 [01:24<00:07,  2.15it/s] 92%|████████████████████████████████████████████████████████████████████████▌      | 180/196 [01:25<00:07,  2.16it/s] 92%|████████████████████████████████████████████████████████████████████████▉      | 181/196 [01:25<00:06,  2.16it/s] 93%|█████████████████████████████████████████████████████████████████████████▎     | 182/196 [01:26<00:06,  2.15it/s] 93%|█████████████████████████████████████████████████████████████████████████▊     | 183/196 [01:26<00:06,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▏    | 184/196 [01:27<00:05,  2.15it/s] 94%|██████████████████████████████████████████████████████████████████████████▌    | 185/196 [01:27<00:05,  2.15it/s] 95%|██████████████████████████████████████████████████████████████████████████▉    | 186/196 [01:28<00:04,  2.15it/s] 95%|███████████████████████████████████████████████████████████████████████████▎   | 187/196 [01:28<00:04,  2.15it/s] 96%|███████████████████████████████████████████████████████████████████████████▊   | 188/196 [01:28<00:03,  2.15it/s] 96%|████████████████████████████████████████████████████████████████████████████▏  | 189/196 [01:29<00:03,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▌  | 190/196 [01:29<00:02,  2.15it/s] 97%|████████████████████████████████████████████████████████████████████████████▉  | 191/196 [01:30<00:02,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▍ | 192/196 [01:30<00:01,  2.15it/s] 98%|█████████████████████████████████████████████████████████████████████████████▊ | 193/196 [01:31<00:01,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:31<00:00,  2.15it/s] 99%|██████████████████████████████████████████████████████████████████████████████▏| 194/196 [01:32<00:00,  2.10it/s]


[Preplexity/llama2-7b-coaxnn-paper/checkpoint-180]: ppl =  tensor(2.4932, device='cuda:0')



[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ [K^C[?2004l[?2004h[?2004l
[?2004h(llama2) [01;32maribra@llama2-l4-gpu-20240515[00m:[01;34m~/llama2/paper/pretraining_paper[00m$ exit
[?2004lexit
